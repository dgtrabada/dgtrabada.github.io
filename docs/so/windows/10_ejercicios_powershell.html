
<!DOCTYPE html>


<html lang="es" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Ejercicios de PowerShell &#8212; dgtrabada</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=40e79d90"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/translations.js?v=f85f4cfb"></script>
    <script src="../../_static/tabs.js?v=3030b3cb"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'so/windows/10_ejercicios_powershell';</script>
    <link rel="icon" href="../../_static/ico.png"/>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Scripting .bat" href="11_bat.html" />
    <link rel="prev" title="PowerShell Scripting" href="10_powershell_scripting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">dgtrabada</p>
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Búsqueda</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../historia/index.html">Historia</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../historia/Introduccion.html">Introducción</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../historia/mecanicos.html">Dispositivos mecánicos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../historia/electricicidad.html">Transición, la electricicidad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../historia/1gen.html">Primera generación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../historia/2gen.html">Segunda generación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../historia/3gen.html">Tercera generación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../historia/4gen.html">Cuarta generación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../historia/SXXI.html">SXXI</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Sistemas Operativos</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../teoria/medida_representacion_informacion.html">Medida y representación de la información</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/sistema_anal%C3%B3gico_digital.html">Sistema analógico &amp; digital</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/medida_informacion.html">Medida de la información</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/representacion_informacion.html">Representación de la información</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/sistemas_numeracion.html">Sistemas de numeración</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/cambio_base_decimales.html">Cambio de base con decimales</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/sistemas_codificacion.html">Sistemas de codificación</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/imagen_digital.html">Imagen digital</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../fundamentos/index.html">Fundamentos de sistemas operativos</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../fundamentos/so_evolucion_sistema_operativo.html">Evolución del Sistema Operativo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fundamentos/so_licencias.html">Tipos software y licencias</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fundamentos/sistemas_operativos.html">Sistemas operativos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fundamentos/gestion_procesos.html">Gestión de procesos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fundamentos/gestion_memoria.html">Gestión de memoria</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fundamentos/sistema_archivos.html">Sistema de archivos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fundamentos/gestion_arranque.html">Gestión arranque</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../maquinas_virtuales.html">La virtualización</a></li>
<li class="toctree-l2"><a class="reference internal" href="../particiones.html">Particiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/raid.html">RAID</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../GNULinux/index.html">GNU/Linux</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/00_historia.html">Historia GNU/Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/01_comandos_basicos.html">Comandos básicos GNU/Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/02_permisos.html">Permisos en GNU/Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/03_usuarios.html">Usuarios y grupos GNU/Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/04_ssh.html">SSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/05_samba.html">Samba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/06_automatizacion_tareas.html">Automatización de tareas y servicios</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/07_comandos_avanzados.html">Comandos avanzados</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/08_NIS.html">NIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/09_GNULinux_NFS.html">NFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/10_slurm.html">Slurm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/11_modules.html">Environment modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/12_ansible.html">Ansible</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/13_ldap.html">LDAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/14_rockylinux.html">Rocky Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/15_shell_scripting.html">Shell Scripting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../GNULinux/15_ejercicios_shell_scripting.html">Ejercicios de shell scripting</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Windows</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01_historia.html">Historia de Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_configuracion.html">Configuración Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_usuarios_grupos.html">Usuarios y grupos Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_arranque.html">Arranque de Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_comandos_dos.html">Comandos ms-dos</a></li>
<li class="toctree-l3"><a class="reference internal" href="06_powershell.html">PowerShell</a></li>
<li class="toctree-l3"><a class="reference internal" href="07_AD_DS.html">Active Directory Domain Services (AD DS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_Caso_practico_AD.html">Casos prácticos : Active Directory con adaptador puente</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_Caso_practico_AD_redint.html">Casos prácticos : Active Directory con red interna</a></li>
<li class="toctree-l3"><a class="reference internal" href="09_Caso_practico_AD_sin_GUI.html">Casos prácticos : Active Directory sin GUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="10_powershell_scripting.html">PowerShell Scripting</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Ejercicios de PowerShell</a></li>
<li class="toctree-l3"><a class="reference internal" href="11_bat.html">Scripting .bat</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../clonacion.html">Clonación</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../hardware/index.html">Hardware</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../teoria/medida_representacion_informacion.html">Medida y representación de la información</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/sistema_anal%C3%B3gico_digital.html">Sistema analógico &amp; digital</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/medida_informacion.html">Medida de la información</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/representacion_informacion.html">Representación de la información</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/sistemas_numeracion.html">Sistemas de numeración</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/cambio_base_decimales.html">Cambio de base con decimales</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/sistemas_codificacion.html">Sistemas de codificación</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../teoria/imagen_digital.html">Imagen digital</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/mantenimiento.html">Mantenimiento de sistemas informáticos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/bios.html">BIOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/uefi.html">UEFI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/diccionario.html">Diccionario de la BIOS/UEFI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/dispositivos_alamacenamiento.html">Dispositivos de almacenamiento</a></li>
<li class="toctree-l2"><a class="reference internal" href="../particiones.html">Particiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/buses.html">Buses y conectores de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/raid.html">RAID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/historia_microsprocesador.html">Breve historia del procesador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/microprocesadores.html">Microprocesadores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/encapsuladors.html">Encapsulados</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/ventilacion.html">Ventilación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/ram.html">Memoria RAM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/puertas_logicas.html">Puertas lógicas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/arquitectura.html">Arquitectura del ordenador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/conceptos_electronicos.html">Conceptos eléctricos - electrónicos y elementos básicos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/fuente_alimentacion.html">Fuentes de Alimentación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/conectores_potencia.html">Cableado y conectores de potencia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/sai.html">Sistemas de alimentación interrumpida</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/carcasa.html">La carcasa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/placa_base.html">La placa base, el “chipset”, la EPROM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/conectores.html">Conectores y buses externos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/tarjetas.html">Tarjetas de expansión</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/perifericos.html">Periféricos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/cpd.html">Centro de Proceso de Datos (CPD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/diagnostico.html">Herramientas de diagnostico</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../redes/index.html">Redes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../redes/sistemas_comunicacion.html">Sistema de comunicación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/tipos_tecnicas_transmision_datos.html">Tipos y técnicas de transmisión de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/sistemas_red.html">Sistemas en red</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/medios_transmision.html">Medios de transmisión</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/perturbaciones.html">Perturbaciones en la transmisión de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/topologia.html">Topologías de red y modos de conexión</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/redes_inalambricas.html">Redes inalámbricas 802.11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/anquitectura_niveles.html">Arquitecturas basadas en niveles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/transporte_datos_equipos_interconexion.html">Transporte de datos y equipos de interconexión</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/Direccionamiento_IP.html">Direccionamiento IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes/cableado_estructurado.html">Cableado Estructurado</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../odoo/index.html">Odoo</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/01_ERP-CRM.html">ERP-CRM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/02_odoo.html">Odoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/03_Inf_empresa.html">Información de la empresa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/04_taza_lapiz_camiseta.html">Taza, lápiz y camiseta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/05_Directorio_fotos.html">Directorio Fotos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/06_instalacion_odoo.html">Instalación odoo y backup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/07_Sitio_Web.html">Sitio Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/08_Usuarios_sistema.html">Usuarios del sistema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/09_empleados.html">Empleados</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/10_copia_seguridad.html">Copia de seguridad</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/11_Inventario.html">Inventario</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/12_ventas.html">Ventas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/13_calendario.html">Calendario</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/14_proyecto.html">Proyecto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/15_encuestas.html">Encuestas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/16_ausencias.html">Ausencias</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/17_tableros.html">Tableros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/18_mantenimineto.html">Mantenimiento</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/19_notas.html">Notas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/20_crm.html">CRM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/21_flota.html">Flota</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/22_punto_venta.html">Punto de venta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/23_restaurante.html">Restaurante</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/24_compra.html">Compra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/25_reparaciones.html">Reparaciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/26_eventos.html">Eventos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/27_modulo.html">Crear un modulo/app</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/28_crear_campo.html">Crear campo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/29_infomod.html">Información del módulo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/30_selfenvuser.html">self.env.user</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/31_menuitem.html">Menuitem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../odoo/32_presentacion.html">Presentación</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../python/index.html">Python</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/so/windows/10_ejercicios_powershell.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ejercicios de PowerShell</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="ejercicios-de-powershell">
<h1>Ejercicios de PowerShell<a class="headerlink" href="#ejercicios-de-powershell" title="Link to this heading">#</a></h1>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">disk.ps1</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>Crea un script llamado <strong>disk.ps1</strong> que imprima por pantalla el porcentaje que esta ocupada la partición C:</p>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># disk.ps1</span>

<span class="c"># Obtener la información de la partición C:</span>
<span class="nv">$disk</span> <span class="p">=</span> <span class="nb">Get-PSDrive</span> <span class="n">-Name</span> <span class="n">C</span>

<span class="c"># Calcular el porcentaje de espacio usado</span>
<span class="nv">$porcentaje</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$disk</span><span class="p">.</span><span class="n">Used</span> <span class="p">/</span> <span class="p">(</span><span class="nv">$disk</span><span class="p">.</span><span class="n">Used</span> <span class="p">+</span> <span class="nv">$disk</span><span class="p">.</span><span class="n">Free</span><span class="p">))</span> <span class="p">*</span> <span class="n">100</span>

<span class="c"># Mostrar el porcentaje de espacio usado</span>
<span class="nb">Write-Output</span> <span class="p">(</span><span class="s2">&quot;C: ocapada al {0:N2}%&quot;</span> <span class="o">-f</span> <span class="nv">$porcentaje</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">mem.ps1</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><p>Crea un script llamado <strong>mem.ps1</strong>, obtiene solamente la memoria en MB ocupada  y se escriban en un archivo llamado free.log cada vez que se ejecute, sin borrar el anterior registro.</p>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># mem.ps1</span>

<span class="c"># Obtener la memoria física total y la memoria libre</span>
<span class="nv">$totalMemory</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-CimInstance</span> <span class="n">Win32_ComputerSystem</span><span class="p">).</span><span class="n">TotalPhysicalMemory</span> <span class="p">/</span> <span class="n">1MB</span>
<span class="nv">$freeMemory</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-CimInstance</span> <span class="n">Win32_OperatingSystem</span><span class="p">).</span><span class="n">FreePhysicalMemory</span> <span class="p">/</span> <span class="n">1MB</span>

<span class="c"># Calcular la memoria ocupada</span>
<span class="nv">$usedMemory</span> <span class="p">=</span> <span class="nv">$totalMemory</span> <span class="p">-</span> <span class="nv">$freeMemory</span>

<span class="c"># Obtener la fecha y hora actual para el registro</span>
<span class="nv">$timestamp</span> <span class="p">=</span> <span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="s2">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>

<span class="c"># Crear el mensaje que se va a escribir en el archivo</span>
<span class="nv">$logEntry</span> <span class="p">=</span> <span class="s2">&quot;$timestamp - Memoria ocupada: </span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">round</span><span class="p">(</span><span class="nv">$usedMemory</span><span class="p">,</span> <span class="n">2</span><span class="p">))</span><span class="s2"> MB&quot;</span>

<span class="c"># Escribir la entrada en el archivo free.log, sin borrar el contenido anterior</span>
<span class="nb">Add-Content</span> <span class="n">-Path</span> <span class="s2">&quot;free.log&quot;</span> <span class="n">-Value</span> <span class="nv">$logEntry</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">cpu.ps1</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><p>Crea un script llamado <strong>cpu.ps1</strong> que saque por pantalla el nombre del procesador instalado en el equipo</p>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># cpu.ps1</span>

<span class="c"># Obtener el nombre del procesador</span>
<span class="nv">$cpuName</span> <span class="p">=</span> <span class="nb">Get-CimInstance</span> <span class="n">-ClassName</span> <span class="n">Win32_Processor</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-ExpandProperty</span> <span class="n">Name</span>

<span class="c"># Mostrar el nombre del procesador en la pantalla</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;CPU: $cpuName&quot;</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">mac.ps1</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">Solución</button><button aria-controls="panel-3-3-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-2" name="3-2" role="tab" tabindex="-1">Solución (foreach)</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><p>Crea un script llamado <strong>mac.ps1</strong> que obtiene la MAC de las tarjetas de red que estén en estado Up</p>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># mac.ps1</span>

<span class="nb">Get-NetAdapter</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Status</span> <span class="o">-eq</span> <span class="s1">&#39;Up&#39;</span><span class="p">}</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">Name</span><span class="p">,</span><span class="n">MacAddress</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-3-2" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-2" name="3-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># mac.ps1</span>

<span class="c"># Obtener todos los adaptadores de red en el sistema</span>
<span class="nv">$networkAdapters</span> <span class="p">=</span> <span class="nb">Get-NetAdapter</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Status</span> <span class="o">-eq</span> <span class="s1">&#39;Up&#39;</span> <span class="p">}</span>

<span class="c"># Iterar sobre cada adaptador para obtener la dirección MAC</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$adapter</span> <span class="k">in</span> <span class="nv">$networkAdapters</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$macAddress</span> <span class="p">=</span> <span class="nv">$adapter</span><span class="p">.</span><span class="n">MacAddress</span>
    <span class="nv">$adapterName</span> <span class="p">=</span> <span class="nv">$adapter</span><span class="p">.</span><span class="n">Name</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Adaptador: $adapterName&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;MAC: $macAddress&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;---------------------------&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">edad.ps1</button><button aria-controls="panel-4-4-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-1" name="4-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>edad.ps1</strong> que te pregunte en que año naciste y te diga la edad que tienes</p>
</div><div aria-labelledby="tab-4-4-1" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-1" name="4-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Script: edad.ps1</span>

<span class="c"># Solicitar al usuario que ingrese su año de nacimiento</span>
<span class="nv">$añoNacimiento</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el año en que naciste&quot;</span>

<span class="c"># Obtener el año actual</span>
<span class="nv">$añoActual</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">Year</span>

<span class="c"># Calcular la edad</span>
<span class="nv">$edad</span> <span class="p">=</span> <span class="nv">$añoActual</span> <span class="p">-</span> <span class="nv">$añoNacimiento</span>

<span class="c"># Mostrar la edad</span>
<span class="nb">Write-Output</span> <span class="s2">&quot;Tienes $edad años.&quot;</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">tres_numeros.ps1</button><button aria-controls="panel-5-5-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-1" name="5-1" role="tab" tabindex="-1">Solución</button><button aria-controls="panel-5-5-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-2" name="5-2" role="tab" tabindex="-1">Solución (usamos decimales)</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>tres_numeros.ps1</strong> que te pregunte al usuario tres numero enteros y devuelva la suma:</p>
</div><div aria-labelledby="tab-5-5-1" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-1" name="5-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">echo </span><span class="s2">&quot;Dame un número&quot;</span>
<span class="no">[int]</span> <span class="nv">$x</span><span class="p">=</span><span class="nb">Read-Host</span>
<span class="nb">echo </span><span class="s2">&quot;Dame un número&quot;</span>
<span class="no">[int]</span> <span class="nv">$y</span><span class="p">=</span><span class="nb">Read-Host</span>
<span class="nb">echo </span><span class="s2">&quot;Dame un número&quot;</span>
<span class="no">[int]</span> <span class="nv">$z</span><span class="p">=</span><span class="nb">Read-Host</span>

<span class="nv">$r</span><span class="p">=</span><span class="nv">$x</span><span class="p">+</span><span class="nv">$y</span><span class="p">+</span><span class="nv">$z</span>

<span class="nb">echo </span><span class="nv">$r</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-5-2" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-2" name="5-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">echo </span><span class="s2">&quot;Dame un número&quot;</span>
<span class="no">[Double]</span> <span class="nv">$x</span><span class="p">=</span><span class="nb">Read-Host</span>
<span class="nb">echo </span><span class="s2">&quot;Dame un número&quot;</span>
<span class="no">[Double]</span> <span class="nv">$y</span><span class="p">=</span><span class="nb">Read-Host</span>
<span class="nb">echo </span><span class="s2">&quot;Dame un número&quot;</span>
<span class="no">[Double]</span><span class="nv">$z</span><span class="p">=</span><span class="nb">Read-Host</span>

<span class="nv">$r</span><span class="p">=</span><span class="nv">$x</span><span class="p">+</span><span class="nv">$y</span><span class="p">+</span><span class="nv">$z</span>

<span class="nb">echo </span> <span class="p">$(</span><span class="s2">&quot;{0:F2}&quot;</span> <span class="o">-f</span> <span class="nv">$r</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-6-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-6-6-0" name="6-0" role="tab" tabindex="0">mult.ps1</button><button aria-controls="panel-6-6-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-6-6-1" name="6-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-6-6-0" class="sphinx-tabs-panel" id="panel-6-6-0" name="6-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>mult.ps1</strong> que pide un número al usuario y muestre su tabla de multiplicar</p>
</div><div aria-labelledby="tab-6-6-1" class="sphinx-tabs-panel" hidden="true" id="panel-6-6-1" name="6-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># mult.ps1</span>

<span class="nv">$number</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Introduce un número para mostrar su tabla de multiplicar&quot;</span>
<span class="nv">$n</span> <span class="p">=</span> <span class="no">[int]</span> <span class="nv">$number</span>

<span class="nb">Write-Host</span> <span class="s2">&quot;Tabla de multiplicar de $n&quot;</span>
<span class="nb">Write-Host</span> <span class="s2">&quot;--------------------------&quot;</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="nv">$r</span> <span class="p">=</span> <span class="nv">$n</span> <span class="p">*</span> <span class="nv">$i</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;$n x $i = $r&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-7-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-7-7-0" name="7-0" role="tab" tabindex="0">ext.ps1</button><button aria-controls="panel-7-7-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-7-7-1" name="7-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-7-7-0" class="sphinx-tabs-panel" id="panel-7-7-0" name="7-0" role="tabpanel" tabindex="0"><p>Crea una carpeta llamada Ejercicio, dentro ejecuta lo siguiente:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">Ejercicio</span>

<span class="nb">cd </span><span class="p">.\</span><span class="n">Ejercicio</span><span class="p">\</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span>
  <span class="nb">echo </span><span class="n">archivo</span> <span class="nv">$i</span> <span class="p">&gt;</span> <span class="n">archivo_</span><span class="nv">$i</span><span class="p">.</span><span class="n">dat</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Si hacemos (C:Users….Ejercicio ls) veremos que se han creado 10 archivos.
Puedes también recorrerlos de la siguiente forma:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$i</span> <span class="k">In</span> <span class="p">$(</span><span class="nb">Get-ChildItem</span> <span class="n">-Filter</span> <span class="p">*.</span><span class="n">dat</span> <span class="p">)){</span>
  <span class="nb">echo </span><span class="s2">&quot;i = $i&quot;</span>
  <span class="p">}</span>
</pre></div>
</div>
<p>Haz un script llamado <strong>ext.ps1</strong> que cambie a todos los archivos la extensión .dat por .txt</p>
</div><div aria-labelledby="tab-7-7-1" class="sphinx-tabs-panel" hidden="true" id="panel-7-7-1" name="7-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># ext.ps1</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$i</span> <span class="k">In</span> <span class="p">$(</span><span class="nb">Get-ChildItem</span> <span class="n">-Filter</span> <span class="p">*.</span><span class="n">dat</span> <span class="p">)){</span>
  <span class="nv">$newName</span> <span class="p">=</span> <span class="nv">$i</span><span class="p">.</span><span class="n">Name</span> <span class="o">-replace</span> <span class="s1">&#39;\.dat$&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span>
  <span class="nb">Rename-Item</span> <span class="nv">$i</span><span class="p">.</span><span class="n">Name</span> <span class="nv">$newName</span>
  <span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-8-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-8-8-0" name="8-0" role="tab" tabindex="0">puerta.ps1</button><button aria-controls="panel-8-8-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-1" name="8-1" role="tab" tabindex="-1">Solución (if)</button><button aria-controls="panel-8-8-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-2" name="8-2" role="tab" tabindex="-1">Solución (switch)</button></div><div aria-labelledby="tab-8-8-0" class="sphinx-tabs-panel" id="panel-8-8-0" name="8-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>puerta.ps1</strong>, que permite al usuario seleccionar entre cuatro puertas de diferentes colores (roja, azul, verde y amarilla). Si el usuario ingresa un código diferente de 1 a 4, se mostrará un mensaje indicando que la puerta es incorrecta.</p>
</div><div aria-labelledby="tab-8-8-1" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-1" name="8-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Script: puerta_if.ps1</span>

<span class="nv">$codigo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot; </span>
<span class="s2">1 - puerta roja</span>
<span class="s2">2 - puerta azul</span>
<span class="s2">3 - puerta verde</span>
<span class="s2">4 - puerta amarilla</span>

<span class="s2">Seleccione una puerta&quot;</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$codigo</span> <span class="o">-eq</span> <span class="n">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta roja.&quot;</span>
<span class="p">}</span>
<span class="k">elseif</span> <span class="p">(</span><span class="nv">$codigo</span> <span class="o">-eq</span> <span class="n">2</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta azul.&quot;</span>
<span class="p">}</span>
<span class="k">elseif</span> <span class="p">(</span><span class="nv">$codigo</span> <span class="o">-eq</span> <span class="n">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta verde.&quot;</span>
<span class="p">}</span>
<span class="k">elseif</span> <span class="p">(</span><span class="nv">$codigo</span> <span class="o">-eq</span> <span class="n">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta amarilla.&quot;</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Puerta incorrecta.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-8-2" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-2" name="8-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Script: puerta.ps1</span>

<span class="nv">$codigo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot; </span>
<span class="s2">1 - puerta roja</span>
<span class="s2">2 - puerta azul</span>
<span class="s2">3 - puerta verde</span>
<span class="s2">4 - puerta amarilla</span>

<span class="s2">Seleccione una puerta&quot;</span>

<span class="k">switch</span> <span class="p">(</span><span class="nv">$codigo</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">1</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta roja.&quot;</span> <span class="p">}</span>
    <span class="n">2</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta azul.&quot;</span> <span class="p">}</span>
    <span class="n">3</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta verde.&quot;</span> <span class="p">}</span>
    <span class="n">4</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta amarilla.&quot;</span> <span class="p">}</span>
    <span class="k">Default</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Puerta incorrecta.&quot;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-9-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-9-9-0" name="9-0" role="tab" tabindex="0">puerta2.ps1</button><button aria-controls="panel-9-9-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-9-9-1" name="9-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-9-9-0" class="sphinx-tabs-panel" id="panel-9-9-0" name="9-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>puerta2.ps1</strong> parecido al anterior, en este caso si el usuario selecciona una puerta que no sea la verde, se muestra un mensaje indicando que ha perdido. Si selecciona la puerta verde, se le permite lanzar una moneda para ver si gana o pierde.</p>
</div><div aria-labelledby="tab-9-9-1" class="sphinx-tabs-panel" hidden="true" id="panel-9-9-1" name="9-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Script: puerta.ps1</span>

<span class="c"># Solicitar al usuario que seleccione una puerta ingresando un número del 1 al 4</span>
<span class="nv">$codigo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Seleccione una puerta (1 - puerta roja, 2 - puerta azul, 3 - puerta verde, 4 - puerta amarilla)&quot;</span>

<span class="c"># Usar switch para seleccionar la puerta según el código ingresado</span>
<span class="k">switch</span> <span class="p">(</span><span class="nv">$codigo</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">1</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta roja. Has perdido.&quot;</span> <span class="p">}</span>
    <span class="n">2</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta azul. Has perdido.&quot;</span> <span class="p">}</span>
    <span class="n">3</span> <span class="p">{</span> 
        <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta verde.&quot;</span>

        <span class="c"># Solicitar al usuario que seleccione entre cara (0) o cruz (1)</span>
        <span class="nv">$moneda</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Lanza la moneda: selecciona cara (0) o cruz (1)&quot;</span>

        <span class="c"># Verificar el resultado de la moneda</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$moneda</span> <span class="o">-eq</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;Has ganado.&quot;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;Has perdido.&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">4</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Has seleccionado la puerta amarilla. Has perdido.&quot;</span> <span class="p">}</span>
    <span class="k">Default</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="s2">&quot;Puerta incorrecta.&quot;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-10-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-10-10-0" name="10-0" role="tab" tabindex="0">usuario.ps1</button><button aria-controls="panel-10-10-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-10-10-1" name="10-1" role="tab" tabindex="-1">Solución (args)</button><button aria-controls="panel-10-10-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-10-10-2" name="10-2" role="tab" tabindex="-1">Solución (args2)</button><button aria-controls="panel-10-10-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-10-10-3" name="10-3" role="tab" tabindex="-1">Solución (param)</button></div><div aria-labelledby="tab-10-10-0" class="sphinx-tabs-panel" id="panel-10-10-0" name="10-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>usuario.ps1</strong> que reciba los siguientes parámetros:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">usuario</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Nombre</span> <span class="n">Mario</span> <span class="n">-Apellido</span> <span class="n">López</span> <span class="n">-Usuario</span> <span class="n">mario33</span> <span class="n">-Nacimiento</span> <span class="n">200</span>
</pre></div>
</div>
<p>El script debe:</p>
<dl class="simple">
<dt>Calcular la edad del usuario.</dt><dd><dl class="simple">
<dt>Si el usuario tiene 14 años o más:</dt><dd><p>Mostrar el mensaje:
Se ha creado a [Nombre] [Apellido] el usuario [Usuario]</p>
</dd>
<dt>Si el usuario tiene menos de 14 años:</dt><dd><p>Mostrar el mensaje:
No se puede crear el usuario [Usuario] a [Nombre] [Apellido] por tener menos de 14</p>
</dd>
</dl>
</dd>
</dl>
</div><div aria-labelledby="tab-10-10-1" class="sphinx-tabs-panel" hidden="true" id="panel-10-10-1" name="10-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$Nombre</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[</span><span class="n">1</span><span class="p">]</span>
<span class="nv">$Apellido</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[</span><span class="n">3</span><span class="p">]</span>
<span class="nv">$Usuario</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[</span><span class="n">5</span><span class="p">]</span>
<span class="nv">$Nacimiento</span> <span class="p">=</span> <span class="no">[int]</span><span class="nv">$args</span><span class="p">[</span><span class="n">7</span><span class="p">]</span>

<span class="nv">$AñoActual</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">Year</span>

<span class="nv">$Edad</span> <span class="p">=</span> <span class="nv">$AñoActual</span> <span class="p">-</span> <span class="nv">$Nacimiento</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$Edad</span> <span class="o">-ge</span> <span class="n">14</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Se ha creado a $Nombre $Apellido el usuario $Usuario&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;No se puede crear el usuario $Usuario a $Nombre $Apellido por tener menos de 14&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-10-2" class="sphinx-tabs-panel" hidden="true" id="panel-10-10-2" name="10-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$Nombre</span> <span class="p">=</span> <span class="s2">&quot;Nombre&quot;</span>
<span class="nv">$Apellido</span> <span class="p">=</span> <span class="s2">&quot;Apellido&quot;</span>
<span class="nv">$Usuario</span> <span class="p">=</span> <span class="s2">&quot;usuario&quot;</span>
<span class="nv">$Nacimiento</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">Year</span>

<span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="nv">$args</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span>

    <span class="k">if</span> <span class="p">(</span> <span class="nv">$args</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">-eq</span> <span class="s1">&#39;-Nombre&#39;</span><span class="p">){</span>
        <span class="nv">$Nombre</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[$(</span><span class="nv">$i</span><span class="p">+</span><span class="n">1</span><span class="p">)]</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$args</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">-eq</span> <span class="s1">&#39;-Apellido&#39;</span><span class="p">){</span>
        <span class="nv">$Apellido</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[$(</span><span class="nv">$i</span><span class="p">+</span><span class="n">1</span><span class="p">)]</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$args</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">-eq</span> <span class="s1">&#39;-Usuario&#39;</span><span class="p">){</span>
        <span class="nv">$Usuario</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[$(</span><span class="nv">$i</span><span class="p">+</span><span class="n">1</span><span class="p">)]</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$args</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">-eq</span> <span class="s1">&#39;-Nacimiento&#39;</span><span class="p">){</span>
        <span class="nv">$Nacimiento</span> <span class="p">=</span> <span class="nv">$args</span><span class="p">[$(</span><span class="nv">$i</span><span class="p">+</span><span class="n">1</span><span class="p">)]</span>
        <span class="p">}</span>

    <span class="p">}</span>


<span class="nv">$AñoActual</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">Year</span>

<span class="nv">$Edad</span> <span class="p">=</span> <span class="nv">$AñoActual</span> <span class="p">-</span> <span class="nv">$Nacimiento</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$Edad</span> <span class="o">-ge</span> <span class="n">14</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Se ha creado a $Nombre $Apellido el usuario $Usuario&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;No se puede crear el usuario $Usuario a $Nombre $Apellido por tener menos de 14&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-10-3" class="sphinx-tabs-panel" hidden="true" id="panel-10-10-3" name="10-3" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">param</span> <span class="p">(</span>
    <span class="c"># en el caso de que no se lo proporcionemos nos dará estos valores por defecto</span>
    <span class="no">[string]</span><span class="nv">$Nombre</span> <span class="p">=</span> <span class="s2">&quot;Nombre&quot;</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$Apellido</span> <span class="p">=</span> <span class="s2">&quot;Apellido&quot;</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$Usuario</span> <span class="p">=</span> <span class="s2">&quot;usuario&quot;</span><span class="p">,</span>
    <span class="no">[int]</span><span class="nv">$Nacimiento</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">Year</span>
    <span class="p">)</span>
    
<span class="nv">$AñoActual</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">Year</span>

<span class="nv">$Edad</span> <span class="p">=</span> <span class="nv">$AñoActual</span> <span class="p">-</span> <span class="nv">$Nacimiento</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$Edad</span> <span class="o">-ge</span> <span class="n">14</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Se ha creado a $Nombre $Apellido el usuario $Usuario&quot;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;No se puede crear el usuario $Usuario a $Nombre $Apellido por tener menos de 14&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-11-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-11-11-0" name="11-0" role="tab" tabindex="0">monedas.ps1</button><button aria-controls="panel-11-11-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-11-11-1" name="11-1" role="tab" tabindex="-1">Solución</button><button aria-controls="panel-11-11-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-11-11-2" name="11-2" role="tab" tabindex="-1">Solución (n monedas)</button></div><div aria-labelledby="tab-11-11-0" class="sphinx-tabs-panel" id="panel-11-11-0" name="11-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>monedas.ps1</strong> que simule el lanzamiento de 3 monedas y calcule la probabilidad de obtener 3 caras</p>
</div><div aria-labelledby="tab-11-11-1" class="sphinx-tabs-panel" hidden="true" id="panel-11-11-1" name="11-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$numero_tiradas</span><span class="p">=</span><span class="n">1000</span>
<span class="nv">$tres_caras</span><span class="p">=</span><span class="n">0</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="nv">$numero_tiradas</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span>
    <span class="nv">$m1</span><span class="p">=$(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="n">2</span><span class="p">)</span>
    <span class="nv">$m2</span><span class="p">=$(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="n">2</span><span class="p">)</span>
    <span class="nv">$m3</span><span class="p">=$(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="n">2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">((</span><span class="nv">$m1</span> <span class="o">-eq</span> <span class="n">0</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="nv">$m2</span> <span class="o">-eq</span> <span class="n">0</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="nv">$m3</span> <span class="o">-eq</span> <span class="n">0</span><span class="p">)){</span>
        <span class="nv">$tres_caras</span><span class="p">++</span>
        <span class="p">}</span>
<span class="p">}</span>

<span class="nb">echo </span><span class="s2">&quot;La probabilidad es (</span><span class="p">$(</span><span class="nv">$tres_caras</span><span class="p">/</span><span class="nv">$numero_tiradas</span><span class="p">)</span><span class="s2">)&quot;</span> 
</pre></div>
</div>
</div><div aria-labelledby="tab-11-11-2" class="sphinx-tabs-panel" hidden="true" id="panel-11-11-2" name="11-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$numero_tiradas</span><span class="p">=</span><span class="n">1000</span>
<span class="nv">$tres_caras</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$N_monedas</span><span class="p">=</span><span class="n">3</span>

<span class="nv">$m</span> <span class="p">=</span> <span class="p">@(</span><span class="n">0</span><span class="p">)*</span><span class="nv">$N_monedas</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$j</span><span class="p">=</span><span class="n">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">-lt</span> <span class="nv">$numero_tiradas</span><span class="p">;</span> <span class="nv">$j</span><span class="p">++){</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="nv">$N_monedas</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span>
        <span class="nv">$m</span><span class="p">[</span><span class="nv">$i</span><span class="p">]=$(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="n">2</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="nv">$todas_cara</span><span class="p">=</span><span class="nv">$true</span>

    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="nv">$N_monedas</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$m</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">-eq</span> <span class="n">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$todas_cara</span><span class="p">=</span><span class="nv">$false</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$todas_cara</span><span class="p">){</span>
        <span class="nv">$tres_caras</span><span class="p">++</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="nb">echo </span><span class="s2">&quot;La probabilidad es (</span><span class="p">$(</span><span class="nv">$tres_caras</span><span class="p">/</span><span class="nv">$numero_tiradas</span><span class="p">)</span><span class="s2">)&quot;</span> 
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-12-12-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-12-12-0" name="12-0" role="tab" tabindex="0">rnd.ps1</button><button aria-controls="panel-12-12-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-12-12-1" name="12-1" role="tab" tabindex="-1">Solución (while)</button><button aria-controls="panel-12-12-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-12-12-2" name="12-2" role="tab" tabindex="-1">Solución (do while)</button><button aria-controls="panel-12-12-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-12-12-3" name="12-3" role="tab" tabindex="-1">Solución (do while)</button></div><div aria-labelledby="tab-12-12-0" class="sphinx-tabs-panel" id="panel-12-12-0" name="12-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>rnd.ps1</strong> que escoja un numero aleatorio entre 1 y 20, pregunte al usuario, le diga si es más pequeño o más grande y que continué hasta que acierte. Cuando el usuario acierte haz que muestre el número de intentos.</p>
</div><div aria-labelledby="tab-12-12-1" class="sphinx-tabs-panel" hidden="true" id="panel-12-12-1" name="12-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># rnd.ps1</span>

<span class="c"># Generar un número aleatorio entre 1 y 20</span>
<span class="nv">$NumeroAleatorio</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">1</span> <span class="n">-Maximum</span> <span class="n">21</span>

<span class="c"># Inicializar el contador de intentos</span>
<span class="nv">$contador</span> <span class="p">=</span> <span class="n">0</span>

<span class="nb">Write-Output</span> <span class="s2">&quot;He generado un número entre 1 y 20. ¡Intenta adivinarlo!&quot;</span>

<span class="c"># Inicializar la respuesta fuera del rango válido para entrar al bucle</span>
<span class="no">[int]</span> <span class="nv">$respuesta</span> <span class="p">=</span> <span class="p">-</span><span class="n">1</span>

<span class="k">while</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-ne</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>

    <span class="no">[int]</span> <span class="nv">$respuesta</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Introduce tu suposición&quot;</span>
    <span class="nv">$contador</span><span class="p">++</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-lt</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El número es mayor que $respuesta. Intenta de nuevo.&quot;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-gt</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El número es menor que $respuesta. Intenta de nuevo.&quot;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-eq</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;¡Felicidades! Has adivinado el número.&quot;</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Número de intentos: $contador&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-12-2" class="sphinx-tabs-panel" hidden="true" id="panel-12-12-2" name="12-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># rnd_do_while.ps1</span>

<span class="c"># Generar un número aleatorio entre 1 y 20</span>
<span class="nv">$NumeroAleatorio</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">1</span> <span class="n">-Maximum</span> <span class="n">21</span>

<span class="c"># Inicializar el contador de intentos</span>
<span class="nv">$contador</span> <span class="p">=</span> <span class="n">0</span>

<span class="nb">Write-Output</span> <span class="s2">&quot;He generado un número entre 1 y 20. ¡Intenta adivinarlo!&quot;</span>

<span class="k">do</span> <span class="p">{</span>

    <span class="no">[int]</span> <span class="nv">$respuesta</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Introduce tu suposición&quot;</span>
    <span class="nv">$contador</span><span class="p">++</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-lt</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El número es mayor que $respuesta. Intenta de nuevo.&quot;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-gt</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El número es menor que $respuesta. Intenta de nuevo.&quot;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-eq</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;¡Felicidades! Has adivinado el número.&quot;</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Número de intentos: $contador&quot;</span>
    <span class="p">}</span>
    
<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-ne</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-12-3" class="sphinx-tabs-panel" hidden="true" id="panel-12-12-3" name="12-3" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># rnd_do_until.ps1</span>

<span class="c"># Generar un número aleatorio entre 1 y 20</span>
<span class="nv">$NumeroAleatorio</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">1</span> <span class="n">-Maximum</span> <span class="n">21</span>

<span class="c"># Inicializar el contador de intentos</span>
<span class="nv">$contador</span> <span class="p">=</span> <span class="n">0</span>

<span class="nb">Write-Output</span> <span class="s2">&quot;He generado un número entre 1 y 20. ¡Intenta adivinarlo!&quot;</span>

<span class="k">do</span> <span class="p">{</span>

    <span class="no">[int]</span> <span class="nv">$respuesta</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Introduce tu suposición&quot;</span>
    <span class="nv">$contador</span><span class="p">++</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-lt</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El número es mayor que $respuesta. Intenta de nuevo.&quot;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-gt</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El número es menor que $respuesta. Intenta de nuevo.&quot;</span>
    <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-eq</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;¡Felicidades! Has adivinado el número.&quot;</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Número de intentos: $contador&quot;</span>
    <span class="p">}</span>
    
<span class="p">}</span> <span class="k">until</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">-eq</span> <span class="nv">$NumeroAleatorio</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-13-13-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-13-13-0" name="13-0" role="tab" tabindex="0">dados.ps1</button><button aria-controls="panel-13-13-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-13-13-1" name="13-1" role="tab" tabindex="-1">Solución (args)</button><button aria-controls="panel-13-13-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-13-13-2" name="13-2" role="tab" tabindex="-1">Solución (param)</button></div><div aria-labelledby="tab-13-13-0" class="sphinx-tabs-panel" id="panel-13-13-0" name="13-0" role="tabpanel" tabindex="0"><p>Haz un script llamado  dados.ps1 que obtenga dos números aleatorios entre el 1 y el 6, haz que la salida se vuelque en un archivo llamado tiradas.csv, en tres columnas, siendo la tercera columna la suma de los dos dados, crea un archivo con al menos 100 tiradas.</p>
<p>Haz que el número de tiradas lo reciba como un argumento, por ejemplo:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">.\</span><span class="n">dados</span><span class="p">.</span><span class="n">ps1</span> <span class="n">100</span>
</pre></div>
</div>
<p>En el caso de que no reciba ningún argumento haz que pregunte cuantas tiradas quieres.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">.\</span><span class="n">dados</span><span class="p">.</span><span class="n">ps1</span>

<span class="err">¿</span><span class="n">Cuántas</span> <span class="n">tiradas</span> <span class="n">quieres</span> <span class="n">hacer</span><span class="p">?</span>
<span class="n">100</span>
</pre></div>
</div>
<p>En el caso de que reciba el argumento help, muestre la siguiente ayuda:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">.\</span><span class="n">dados</span><span class="p">.</span><span class="n">ps1</span> <span class="n">help</span>

<span class="n">Uso</span> <span class="nb">del </span><span class="n">script</span> <span class="n">dados</span><span class="p">.</span><span class="n">ps1</span><span class="p">:</span>
<span class="p">.\</span><span class="n">dados</span><span class="p">.</span><span class="n">ps1</span> <span class="p">&lt;</span><span class="n">número_de_tiradas</span><span class="p">&gt;</span>
<span class="n">Ejemplo</span><span class="p">:</span> <span class="p">.\</span><span class="n">dados</span><span class="p">.</span><span class="n">ps1</span> <span class="n">100</span>
<span class="nb">Si </span><span class="n">no</span> <span class="n">se</span> <span class="n">proporciona</span> <span class="n">ningún</span> <span class="n">argumento</span><span class="p">,</span> <span class="n">se</span> <span class="n">preguntará</span> <span class="n">cuántas</span> <span class="n">tiradas</span> <span class="n">deseas</span> <span class="n">hacer</span><span class="p">.</span>
<span class="nb">Si </span><span class="n">se</span> <span class="n">usa</span> <span class="n">el</span> <span class="n">argumento</span> <span class="s1">&#39;help&#39;</span><span class="p">,</span> <span class="n">se</span> <span class="n">mostrará</span> <span class="n">esta</span> <span class="n">ayuda</span><span class="p">.</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-13-1" class="sphinx-tabs-panel" hidden="true" id="panel-13-13-1" name="13-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># dados.ps1</span>

<span class="k">function</span> <span class="n">Tirar_dados</span><span class="p">(</span><span class="nv">$Tiradas</span><span class="p">){</span>
    <span class="s2">&quot;dado1,dado2,suma&quot;</span> <span class="p">&gt;</span> <span class="n">tiradas</span><span class="p">.</span><span class="n">csv</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="nv">$Tiradas</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
        <span class="nv">$dado1</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">1</span> <span class="n">-Maximum</span> <span class="n">7</span>
        <span class="nv">$dado2</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">1</span> <span class="n">-Maximum</span> <span class="n">7</span>
        <span class="nv">$suma</span> <span class="p">=</span> <span class="nv">$dado1</span> <span class="p">+</span> <span class="nv">$dado2</span>
        <span class="s2">&quot;$dado1,$dado2,$suma&quot;</span> <span class="p">&gt;&gt;</span> <span class="n">tiradas</span><span class="p">.</span><span class="n">csv</span>
        <span class="p">}</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;$Tiradas tiradas generadas y guardadas en tiradas.csv&quot;</span>
    <span class="p">}</span>

<span class="k">function</span> <span class="nb">Show-Help</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Uso del script dados.ps1:&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;.\dados.ps1 &lt;número_de_tiradas&gt;&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Ejemplo: .\dados.ps1 100&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Si no se proporciona ningún argumento, se preguntará cuántas tiradas deseas hacer.&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Si se usa el argumento &#39;help&#39;, se mostrará esta ayuda.&quot;</span>
    <span class="p">}</span>

<span class="no">[int]</span> <span class="nv">$Tiradas</span> <span class="p">=</span> <span class="n">0</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$args</span><span class="p">.</span><span class="n">Length</span> <span class="o">-eq</span> <span class="n">0</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$Tiradas</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;¿Cuántas tiradas quieres hacer?&quot;</span>
    <span class="n">Tirar_dados</span><span class="p">(</span><span class="nv">$Tiradas</span><span class="p">)</span>

    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="nv">$args</span><span class="p">[</span><span class="n">0</span><span class="p">]</span> <span class="o">-eq</span> <span class="s2">&quot;help&quot;</span><span class="p">){</span>
        <span class="nb">Show-Help</span>        
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nv">$Tiradas</span> <span class="p">=</span> <span class="no">[int]</span> <span class="nv">$args</span><span class="p">[</span><span class="n">0</span><span class="p">]</span>
        <span class="n">Tirar_dados</span><span class="p">(</span><span class="nv">$Tiradas</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-13-2" class="sphinx-tabs-panel" hidden="true" id="panel-13-13-2" name="13-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># dados.ps1</span>
<span class="k">param</span> <span class="p">(</span>
    <span class="no">[string]</span> <span class="nv">$Tiradas</span>
<span class="p">)</span>

<span class="k">function</span> <span class="n">Tirar_dados</span><span class="p">(</span><span class="no">[int]</span> <span class="nv">$Tiradas</span><span class="p">){</span>
    <span class="s2">&quot;dado1,dado2,suma&quot;</span> <span class="p">&gt;</span> <span class="n">tiradas</span><span class="p">.</span><span class="n">csv</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="nv">$Tiradas</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
        <span class="nv">$dado1</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">1</span> <span class="n">-Maximum</span> <span class="n">7</span>
        <span class="nv">$dado2</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">1</span> <span class="n">-Maximum</span> <span class="n">7</span>
        <span class="nv">$suma</span> <span class="p">=</span> <span class="nv">$dado1</span> <span class="p">+</span> <span class="nv">$dado2</span>
        <span class="s2">&quot;$dado1,$dado2,$suma&quot;</span> <span class="p">&gt;&gt;</span> <span class="n">tiradas</span><span class="p">.</span><span class="n">csv</span>
        <span class="p">}</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;$Tiradas tiradas generadas y guardadas en tiradas.csv&quot;</span>
    <span class="p">}</span>

<span class="k">function</span> <span class="nb">Show-Help</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Uso del script dados.ps1:&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;.\dados.ps1 &lt;número_de_tiradas&gt;&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Ejemplo: .\dados.ps1 100&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Si no se proporciona ningún argumento, se preguntará cuántas tiradas deseas hacer.&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Si se usa el argumento &#39;help&#39;, se mostrará esta ayuda.&quot;</span>
<span class="p">}</span>


<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$Tiradas</span><span class="p">)</span> <span class="p">{</span>

    <span class="nv">$Tiradas</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;¿Cuántas tiradas quieres hacer?&quot;</span>
    <span class="n">Tirar_dados</span><span class="p">(</span><span class="nv">$Tiradas</span><span class="p">)</span>

    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="nv">$Tiradas</span> <span class="o">-eq</span> <span class="s2">&quot;help&quot;</span><span class="p">){</span>
        <span class="nb">Show-Help</span>        
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">Tirar_dados</span><span class="p">(</span><span class="nv">$Tiradas</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-14-14-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-14-14-0" name="14-0" role="tab" tabindex="0">analisis.ps1</button><button aria-controls="panel-14-14-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-14-14-1" name="14-1" role="tab" tabindex="-1">Solución (variables)</button><button aria-controls="panel-14-14-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-14-14-2" name="14-2" role="tab" tabindex="-1">Solución (arrays)</button></div><div aria-labelledby="tab-14-14-0" class="sphinx-tabs-panel" id="panel-14-14-0" name="14-0" role="tabpanel" tabindex="0"><p>Lee el archivo que has generado en el ejercicio anterior y haz que salga por pantalla el numero de tiradas y el porcentaje de veces que sale cada una, por ejemplo</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">$</span> <span class="p">./</span><span class="n">analisis</span><span class="p">.</span><span class="n">ps1</span>

<span class="n">De</span> <span class="n">1000</span> <span class="n">tiradas</span> <span class="p">:</span> <span class="n">2</span><span class="p">(</span><span class="n">1</span><span class="p">%)</span> <span class="n">3</span><span class="p">(</span><span class="n">7</span><span class="p">%)</span> <span class="n">4</span><span class="p">(</span><span class="n">10</span><span class="p">%)</span> <span class="n">5</span><span class="p">(</span><span class="n">12</span><span class="p">%)</span> <span class="n">6</span><span class="p">(</span><span class="n">14</span><span class="p">%)</span> <span class="n">7</span><span class="p">(</span><span class="n">17</span><span class="p">%)</span> <span class="n">8</span><span class="p">(</span><span class="n">14</span><span class="p">%)</span> <span class="n">9</span><span class="p">(</span><span class="n">12</span><span class="p">%)</span> <span class="n">10</span><span class="p">(</span><span class="n">10</span><span class="p">%)</span> <span class="n">11</span><span class="p">(</span><span class="n">7</span><span class="p">%)</span> <span class="n">12</span><span class="p">(</span><span class="n">1</span><span class="p">%)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-14-1" class="sphinx-tabs-panel" hidden="true" id="panel-14-14-1" name="14-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># analisis.ps1</span>

<span class="nv">$A</span> <span class="p">=</span> <span class="nb">Import-Csv</span> <span class="n">-Path</span> <span class="n">tiradas</span><span class="p">.</span><span class="n">csv</span>
<span class="nv">$total</span><span class="p">=</span><span class="nv">$A</span><span class="p">.</span><span class="n">Count</span>
<span class="nb">echo </span><span class="s2">&quot;leemos $total tiradas&quot;</span>

<span class="nv">$s2</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s3</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s4</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s5</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s6</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s7</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s8</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s9</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s10</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s11</span><span class="p">=</span><span class="n">0</span>
<span class="nv">$s12</span><span class="p">=</span><span class="n">0</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$i</span> <span class="k">in</span> <span class="nv">$A</span><span class="p">.</span><span class="n">Suma</span><span class="p">){</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">2</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s2</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">3</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s3</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">4</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s4</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">5</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s5</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">6</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s6</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">7</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s7</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">8</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s8</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">9</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s9</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">10</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s10</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">11</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s11</span><span class="p">++}</span>
  <span class="k">if</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-eq</span> <span class="n">12</span><span class="p">)</span> <span class="p">{</span><span class="nv">$s12</span><span class="p">++}</span>

<span class="p">}</span>

<span class="nv">$salida</span><span class="p">=</span><span class="s2">&quot;2 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s2</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;3 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s3</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;4 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s4</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;5 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s5</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;6 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s6</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;7 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s7</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;8 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s8</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;9 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s9</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;10 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s10</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;11 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s11</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%), &quot;</span>
<span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;12 (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s12</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%)&quot;</span>

<span class="nb">echo </span><span class="nv">$salida</span> 
</pre></div>
</div>
</div><div aria-labelledby="tab-14-14-2" class="sphinx-tabs-panel" hidden="true" id="panel-14-14-2" name="14-2" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># analisis.ps1</span>

<span class="nv">$A</span> <span class="p">=</span> <span class="nb">Import-Csv</span> <span class="n">-Path</span> <span class="n">tiradas</span><span class="p">.</span><span class="n">csv</span>
<span class="nv">$total</span><span class="p">=</span><span class="nv">$A</span><span class="p">.</span><span class="n">Count</span>
<span class="nb">echo </span><span class="s2">&quot;leemos $total tiradas&quot;</span>

<span class="c">#inicializamos la matriz con 13 elementos</span>
<span class="nv">$s</span> <span class="p">=</span> <span class="p">@(</span><span class="n">0</span><span class="p">)*</span><span class="n">13</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">2</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="n">13</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span>
    <span class="nv">$s</span><span class="p">[</span><span class="nv">$i</span><span class="p">]=</span><span class="n">0</span>
    <span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$i</span> <span class="k">in</span> <span class="nv">$A</span><span class="p">.</span><span class="n">Suma</span><span class="p">){</span>
    <span class="nv">$s</span><span class="p">[</span><span class="nv">$i</span><span class="p">]++</span>
    <span class="p">}</span>

<span class="nv">$salida</span><span class="p">=</span><span class="s2">&quot;&quot;</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">2</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="n">13</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span>
    <span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;$i (</span><span class="p">$(</span><span class="no">[math]</span><span class="p">::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$s</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="p">/</span> <span class="nv">$total</span><span class="p">)</span> <span class="p">*</span> <span class="n">100</span><span class="p">,</span> <span class="n">0</span><span class="p">))</span><span class="s2">%)&quot;</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="n">12</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$salida</span><span class="p">+=</span><span class="s2">&quot;, &quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="nb">echo </span><span class="nv">$salida</span>  
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-15-15-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-15-15-0" name="15-0" role="tab" tabindex="0">tragaperras.ps1</button><button aria-controls="panel-15-15-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-15-15-1" name="15-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-15-15-0" class="sphinx-tabs-panel" id="panel-15-15-0" name="15-0" role="tabpanel" tabindex="0"><p>Un jugador comienza con 100 € para jugar en una máquina tragamonedas. El funcionamiento de la máquina es el siguiente:</p>
<ul class="simple">
<li><p>Cada partida cuesta 1 €.</p></li>
<li><p>La máquina tiene 3 rulos. <code class="docutils literal notranslate"><span class="pre">$rulos</span> <span class="pre">=</span> <span class="pre">&#64;('limon',</span> <span class="pre">'manzana',</span> <span class="pre">'platano',</span> <span class="pre">'siete')</span></code></p>
<ul>
<li><p>Tres frutas iguales (por ejemplo, 3 limones): el jugador gana 1 €.</p></li>
<li><p>Tres sietes: el jugador gana 100 €.</p></li>
</ul>
</li>
<li><p>Si el jugador no tiene suficiente dinero para jugar (menos de 1 €), deja de jugar.</p></li>
</ul>
<p>Simula la evolución del dinero del jugador durante 1000 partidas o hasta que su dinero se agote, lo que ocurra primero.</p>
<p>El objetivo es determinar cuánto dinero tiene el jugador al final de las 1000 partidas y cuántas partidas logró jugar en total.</p>
</div><div aria-labelledby="tab-15-15-1" class="sphinx-tabs-panel" hidden="true" id="panel-15-15-1" name="15-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$rulos</span> <span class="p">=</span> <span class="p">@(</span><span class="s1">&#39;limon&#39;</span><span class="p">,</span> <span class="s1">&#39;manzana&#39;</span><span class="p">,</span> <span class="s1">&#39;platano&#39;</span><span class="p">,</span> <span class="s1">&#39;siete&#39;</span><span class="p">)</span>
<span class="nv">$numero_tiradas</span><span class="p">=</span><span class="n">1000</span>

<span class="k">function</span> <span class="n">Girar-Rulos</span> <span class="p">{</span>
    <span class="nv">$ganacia</span> <span class="p">=</span> <span class="p">-</span><span class="n">1</span>
    <span class="nv">$rulo1</span><span class="p">=</span><span class="nv">$rulos</span><span class="p">[(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="nv">$rulos</span><span class="p">.</span><span class="n">Length</span><span class="p">)]</span>
    <span class="nv">$rulo2</span><span class="p">=</span><span class="nv">$rulos</span><span class="p">[(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="nv">$rulos</span><span class="p">.</span><span class="n">Length</span><span class="p">)]</span>
    <span class="nv">$rulo3</span><span class="p">=</span><span class="nv">$rulos</span><span class="p">[(</span><span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="nv">$rulos</span><span class="p">.</span><span class="n">Length</span><span class="p">)]</span>

    <span class="k">if</span><span class="p">(</span> <span class="p">(</span><span class="nv">$rulo1</span> <span class="o">-eq</span> <span class="nv">$rulo2</span><span class="p">)</span> <span class="o">-and</span> <span class="p">(</span><span class="nv">$rulo1</span> <span class="o">-eq</span> <span class="nv">$rulo3</span><span class="p">)</span>  <span class="p">){</span>
        <span class="nv">$ganacia</span><span class="p">+=</span><span class="n">1</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$rulo1</span> <span class="o">-eq</span> <span class="s2">&quot;siete&quot;</span><span class="p">){</span>
            <span class="nv">$ganacia</span><span class="p">+=</span><span class="n">99</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="c">#Write-Output &quot;$rulo1,$rulo2,$rulo3&quot;</span>
    <span class="k">return</span> <span class="nv">$ganacia</span>
    <span class="p">}</span>

<span class="nv">$jugador</span><span class="p">=</span><span class="n">10</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$j</span><span class="p">=</span><span class="n">0</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">-lt</span> <span class="nv">$numero_tiradas</span><span class="p">;</span> <span class="nv">$j</span><span class="p">++){</span>
    <span class="nv">$jugador</span><span class="p">+=</span><span class="n">Girar-Rulos</span>
    <span class="nb">Write-Output</span> <span class="nv">$jugador</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$jugador</span> <span class="o">-lt</span> <span class="n">0</span><span class="p">){</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;se arruina con $j tiradas &quot;</span>
        <span class="c">#exit</span>
        <span class="nv">$j</span><span class="p">=</span><span class="nv">$numero_tiradas</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-16-16-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-16-16-0" name="16-0" role="tab" tabindex="0">csv.ps1</button><button aria-controls="panel-16-16-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-16-16-1" name="16-1" role="tab" tabindex="-1">Solución</button><button aria-controls="panel-16-16-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-16-16-2" name="16-2" role="tab" tabindex="-1">-delete</button><button aria-controls="panel-16-16-3" aria-selected="false" class="sphinx-tabs-tab" id="tab-16-16-3" name="16-3" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-16-16-0" class="sphinx-tabs-panel" id="panel-16-16-0" name="16-0" role="tabpanel" tabindex="0"><p>Crea un script en PowerShell llamado <strong>csv.ps1</strong> que cumpla con las siguientes características:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">csv</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-usuario</span> <span class="no">[nombre usuario]</span> <span class="n">-grupo</span> <span class="no">[grupo]</span>
</pre></div>
</div>
<p>El script debe agregar una entrada al archivo usuarios.csv (si no existe, debe crearlo).
El archivo usuarios.csv tendrá el siguiente formato:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">usuario</span><span class="p">,</span><span class="n">grupo</span><span class="p">,</span><span class="n">password</span>
<span class="n">alice</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">12D7087D61</span>
<span class="n">bob</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">5CD356CE5</span>
</pre></div>
</div>
<p>La contraseña debe generarse de forma aleatoria, haz que sea una cadena alfanumérica de 8 caracteres.</p>
<p>Al ejecutar el script, debe mostrar un mensaje en la terminal indicando que el usuario ha sido creado. El mensaje debe seguir el formato:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">El</span> <span class="n">usuario</span> <span class="no">[usuario] ha sido creado con la password [password] en el grupo [grupo]</span><span class="p">.</span>
</pre></div>
</div>
<p>En el caso de que el usuario exista, la salida será :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">El</span> <span class="n">usuario</span> <span class="no">[usuario]</span> <span class="n">ya</span> <span class="n">existe</span><span class="p">,</span> <span class="n">no</span> <span class="n">se</span> <span class="n">puede</span> <span class="n">crear</span><span class="p">.</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-16-1" class="sphinx-tabs-panel" hidden="true" id="panel-16-16-1" name="16-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">param</span> <span class="p">(</span>
    <span class="c">#[Parameter(Mandatory = $true)] en el caso de que ingreses usuario, te lo pregunta</span>
    <span class="no">[string]</span><span class="nv">$usuario</span><span class="p">,</span>
       
    <span class="no">[string]</span><span class="nv">$grupo</span><span class="p">=</span><span class="s2">&quot;A&quot;</span>
<span class="p">)</span>

<span class="nv">$archivoCSV</span> <span class="p">=</span> <span class="s2">&quot;usuarios.csv&quot;</span>


<span class="k">if</span><span class="p">(!</span> <span class="nv">$usuario</span><span class="p">){</span> <span class="c">#caso de no recibir nombre de usuario se para</span>
<span class="nb">echo </span><span class="s2">&quot;no me han dado usuario&quot;</span>
<span class="n">exit</span>
<span class="p">}</span>


<span class="k">function</span> <span class="n">GenerarPassword</span> <span class="p">{</span>
    <span class="nv">$chars</span> <span class="p">=</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#~$%&amp;&quot;</span>
    <span class="nv">$salida</span><span class="p">=</span><span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="n">8</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span> 
     <span class="nv">$r</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="nv">$chars</span><span class="p">.</span><span class="n">Length</span>
     <span class="nv">$salida</span><span class="p">+=</span><span class="nv">$chars</span><span class="p">[</span><span class="nv">$r</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="nb">Write-Output</span> <span class="nv">$salida</span>
<span class="p">}</span>

<span class="c"># Si no existe crear el encabezado</span>
<span class="k">if</span> <span class="p">(!(</span><span class="nb">Test-Path</span> <span class="nv">$archivoCSV</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;usuario,grupo,password&quot;</span> <span class="p">&gt;</span>  <span class="nv">$archivoCSV</span> 
<span class="p">}</span>

<span class="c"># Si el usuario ya existe</span>
<span class="nv">$usuariosExistentes</span> <span class="p">=</span> <span class="nb">Import-Csv</span> <span class="n">-Path</span> <span class="nv">$archivoCSV</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$usuariosExistentes</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">usuario</span> <span class="o">-eq</span> <span class="nv">$usuario</span> <span class="p">})</span> 
<span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $usuario ya existe, no se puede crear.&quot;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="nv">$password</span> <span class="p">=</span> <span class="n">GenerarPassword</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;$usuario,$grupo,$password&quot;</span> <span class="p">&gt;&gt;</span> <span class="nv">$archivoCSV</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $usuario ha sido creado con la password $password en el grupo $grupo.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-16-2" class="sphinx-tabs-panel" hidden="true" id="panel-16-16-2" name="16-2" role="tabpanel" tabindex="0"><p>En el caso de que pongamos <strong>-delete</strong> borrara el usuario del archvio csv</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">csv</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-usuario</span> <span class="no">[nombre usuario]</span> <span class="n">-delete</span>
<span class="n">El</span> <span class="n">usuario</span> <span class="no">[usuario]</span> <span class="n">ha</span> <span class="n">sido</span> <span class="n">borrado</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-16-3" class="sphinx-tabs-panel" hidden="true" id="panel-16-16-3" name="16-3" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">param</span> <span class="p">(</span>

    <span class="c">#[Parameter(Mandatory = $true)] en el caso de que ingreses usuario, te lo pregunta</span>
    <span class="no">[string]</span><span class="nv">$usuario</span><span class="p">,</span>
       
    <span class="no">[string]</span><span class="nv">$grupo</span><span class="p">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span>

    <span class="no">[switch]</span><span class="nv">$delete</span>
<span class="p">)</span>


<span class="nv">$archivoCSV</span> <span class="p">=</span> <span class="s2">&quot;usuarios.csv&quot;</span>


<span class="k">if</span><span class="p">(!</span> <span class="nv">$usuario</span><span class="p">){</span> <span class="c">#caso de no recibir nombre de usuario se para</span>
<span class="nb">echo </span><span class="s2">&quot;no me han dado usuario&quot;</span>
<span class="n">exit</span>
<span class="p">}</span>


<span class="k">function</span> <span class="n">GenerarPassword</span> <span class="p">{</span>
    <span class="nv">$chars</span> <span class="p">=</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#~$%&amp;&quot;</span>
    <span class="nv">$salida</span><span class="p">=</span><span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span><span class="nv">$i</span> <span class="o">-lt</span> <span class="n">8</span><span class="p">;</span><span class="nv">$i</span><span class="p">++){</span> 
     <span class="nv">$r</span> <span class="p">=</span> <span class="nb">Get-Random</span> <span class="n">-Minimum</span> <span class="n">0</span> <span class="n">-Maximum</span> <span class="nv">$chars</span><span class="p">.</span><span class="n">Length</span>
     <span class="nv">$salida</span><span class="p">+=</span><span class="nv">$chars</span><span class="p">[</span><span class="nv">$r</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="nb">Write-Output</span> <span class="nv">$salida</span>
<span class="p">}</span>

<span class="c"># Si no existe crear el encabezado</span>
<span class="k">if</span> <span class="p">(!(</span><span class="nb">Test-Path</span> <span class="nv">$archivoCSV</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;usuario,grupo,password&quot;</span> <span class="p">&gt;</span>  <span class="nv">$archivoCSV</span> 
<span class="p">}</span>

<span class="c"># Si el usuario ya existe</span>
<span class="nv">$usuariosExistentes</span> <span class="p">=</span> <span class="nb">Import-Csv</span> <span class="n">-Path</span> <span class="nv">$archivoCSV</span>


<span class="k">if</span> <span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$usuariosExistentes</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">usuario</span> <span class="o">-eq</span> <span class="nv">$usuario</span> <span class="p">})</span> <span class="p">{</span>
        <span class="nv">$usuariosActualizados</span> <span class="p">=</span> <span class="nv">$usuariosExistentes</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">usuario</span> <span class="o">-ne</span> <span class="nv">$usuario</span> <span class="p">}</span>
        <span class="c">#-NoTypeInformationdeja un archivo más limpio</span>
        <span class="nv">$usuariosActualizados</span> <span class="p">|</span> <span class="nb">Export-Csv</span> <span class="n">-Path</span> <span class="nv">$archivoCSV</span> <span class="n">-NoTypeInformation</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $usuario ha sido eliminado del archivo.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $usuario no existe, no se puede eliminar.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span><span class="n">esle</span><span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$usuariosExistentes</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">usuario</span> <span class="o">-eq</span> <span class="nv">$usuario</span> <span class="p">})</span> 
    <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $usuario ya existe, no se puede crear.&quot;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nv">$password</span> <span class="p">=</span> <span class="n">GenerarPassword</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;$usuario,$grupo,$password&quot;</span> <span class="p">&gt;&gt;</span> <span class="nv">$archivoCSV</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $usuario ha sido creado con la password $password en el grupo $grupo.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-17-17-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-17-17-0" name="17-0" role="tab" tabindex="0">crear_usuarios_grupos.ps1</button><button aria-controls="panel-17-17-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-17-17-1" name="17-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-17-17-0" class="sphinx-tabs-panel" id="panel-17-17-0" name="17-0" role="tabpanel" tabindex="0"><p>Crea un script llamado <strong>crear_usuarios_grupos.ps1</strong> que cree los siguientes grupos:</p>
<ul class="simple">
<li><p>GPWS01</p></li>
<li><p>GPWS02</p></li>
<li><p>…</p></li>
<li><p>GPWS09</p></li>
</ul>
<ol class="arabic">
<li><p>En el caso de que el grupo no exista, haz que lo cree y saque por pantalla:</p>
<p><strong>El grupo $nombre_grupo no existe, se crea</strong></p>
</li>
<li><p>En el caso de que el grupo exista haz que no lo intente y saque por pantalla:</p>
<p><strong>El grupo $nombre_grupo existe, no se crea</strong></p>
</li>
</ol>
<p>ayuda : $nombre_grupo=”GPWS03” ;  Get-LocalGroup | Select-String -Pattern $nombre_grupo -Quiet</p>
</div><div aria-labelledby="tab-17-17-1" class="sphinx-tabs-panel" hidden="true" id="panel-17-17-1" name="17-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># crear_usuarios_grupos.ps1</span>

<span class="c"># Bucle para crear los grupos GPWS01 a GPWS09</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="n">9</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    
    <span class="nv">$nombre_grupo</span> <span class="p">=</span> <span class="s2">&quot;GPWS{0:D2}&quot;</span> <span class="o">-f</span> <span class="nv">$i</span>
    <span class="nv">$grupo_existe</span> <span class="p">=</span>  <span class="nb">Get-LocalGroup</span> <span class="p">|</span> <span class="nb">Select-String</span> <span class="n">-Pattern</span> <span class="nv">$nombre_grupo</span> <span class="n">-Quiet</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$grupo_existe</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombre_grupo existe, no se crea&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c"># Si el grupo no existe, crear el grupo</span>
        <span class="nb">New-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombre_grupo</span> <span class="n">-Description</span> <span class="s2">&quot;Grupo $nombre_grupo creado&quot;</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombre_grupo no existe, se crea&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-18-18-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-18-18-0" name="18-0" role="tab" tabindex="0">crear_usuarios_grupos.ps1</button><button aria-controls="panel-18-18-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-18-18-1" name="18-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-18-18-0" class="sphinx-tabs-panel" id="panel-18-18-0" name="18-0" role="tabpanel" tabindex="0"><p>Haz que el anterior script cree los siguientes usuarios dentro de los grupos correspondientes, con la contraseña alumno.         Además haz que estén dentro del grupo Usuarios para que puedan loguearse utilizando el entorno gráfico</p>
<ul class="simple">
<li><p>GPWS01</p>
<ul>
<li><p>tunombre_gpws01_01</p></li>
<li><p>tunombre_gpws01_02</p></li>
<li><p>…</p></li>
<li><p>tunombre_gpws01_08</p></li>
<li><p>tunombre_gpws01_09</p></li>
</ul>
</li>
<li><p>GPWS02</p>
<ul>
<li><p>tunombre_gpws02_01</p></li>
<li><p>tunombre_gpws02_02</p></li>
<li><p>…</p></li>
<li><p>tunombre_gpws02_08</p></li>
<li><p>tunombre_gpws02_09</p></li>
</ul>
</li>
<li><p>…</p>
<ul>
<li><p>…</p></li>
<li><p>…</p></li>
</ul>
</li>
<li><p>GPWS09</p>
<ul>
<li><p>tunombre_gpws09_01</p></li>
<li><p>tunombre_gpws09_02</p></li>
<li><p>…</p></li>
<li><p>tunombre_gpws09_08</p></li>
<li><p>tunombre_gpws09_09</p></li>
</ul>
</li>
</ul>
<ol class="arabic">
<li><p>En el caso de que el usuario no exista, haz que lo cree  y lo incorpore a su grupo, finalmente saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario con grupo $nombre_grupo no existe, se crea</strong></p>
</li>
<li><p>En el caso de que el usuario exista haz que no lo intente y saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario existe, no se crea</strong></p>
</li>
<li><p>En el caso de que el usuario no este en el grupo, haz que lo menta dentro del grupo y saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario no esta en el grupo $nombre_grupo, se hace miembro</strong></p>
</li>
<li><p>En el caso de que el usuario este en el grupo, haz que saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario ya esta en el grupo $nombre_grupo no se hace nada</strong></p>
</li>
</ol>
<p>ayuda: Puedes borrar los usuarios y grupos :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$i</span> <span class="k">in</span>  <span class="p">$(</span><span class="nb">Get-LocalUser</span> <span class="p">|</span><span class="nb">sls </span><span class="n">-Pattern</span> <span class="s2">&quot;tunombre_&quot;</span><span class="p">)){</span>
  <span class="nb">Remove-LocalUser</span> <span class="n">-Name</span> <span class="nv">$i</span>
  <span class="p">}</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nv">$i</span> <span class="k">in</span>  <span class="p">$(</span><span class="nb">Get-LocalGroup</span> <span class="p">|</span><span class="nb">sls </span><span class="n">-Pattern</span>  <span class="s2">&quot;GPWS&quot;</span><span class="p">)){</span>
  <span class="nb">Remove-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$i</span>
  <span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-18-1" class="sphinx-tabs-panel" hidden="true" id="panel-18-18-1" name="18-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># crear_usuarios_grupos.ps1</span>

<span class="nv">$nombre_base</span> <span class="p">=</span> <span class="s2">&quot;tunombre_gpws&quot;</span>

<span class="c">#Si da problemas poner una contraseña más compleja</span>
<span class="nv">$contraseña</span> <span class="p">=</span> <span class="s2">&quot;alumno&quot;</span>

<span class="c"># Bucle para crear los grupos GPWS01 a GPWS09</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="n">9</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="c"># Formatear el nombre del grupo</span>
    <span class="nv">$nombre_grupo</span> <span class="p">=</span> <span class="s2">&quot;GPWS{0:D2}&quot;</span> <span class="o">-f</span> <span class="nv">$i</span>
    
    <span class="c"># Verificar si el grupo ya existe</span>
    <span class="nv">$grupo_existe</span> <span class="p">=</span> <span class="nb">Get-LocalGroup</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="nv">$nombre_grupo</span> <span class="p">}</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="nv">$grupo_existe</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombre_grupo existe, no se crea&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">New-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombre_grupo</span> <span class="n">-Description</span> <span class="s2">&quot;Grupo $nombre_grupo creado automáticamente&quot;</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombre_grupo no existe, se crea&quot;</span>
    <span class="p">}</span>

    <span class="c"># Bucle para crear los usuarios tunombre_gpwsXX_01 a tunombre_gpwsXX_09</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$j</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$j</span> <span class="o">-le</span> <span class="n">9</span><span class="p">;</span> <span class="nv">$j</span><span class="p">++)</span> <span class="p">{</span>
        <span class="c"># Formatear el nombre del usuario</span>
        <span class="nv">$nombre_usuario</span> <span class="p">=</span> <span class="s2">&quot;{0}{1:D2}_{2:D2}&quot;</span> <span class="o">-f</span> <span class="nv">$nombre_base</span><span class="p">,</span> <span class="nv">$i</span><span class="p">,</span> <span class="nv">$j</span>
        
        <span class="c"># Verificar si el usuario ya existe</span>
        <span class="nv">$usuario_existe</span> <span class="p">=</span> <span class="nb">Get-LocalUser</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="nv">$nombre_usuario</span> <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nv">$usuario_existe</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario existe, no se crea&quot;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c"># Crear el usuario con la contraseña especificada</span>
            <span class="nb">New-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombre_usuario</span> <span class="n">-Password</span> <span class="p">(</span><span class="nb">ConvertTo-SecureString</span> <span class="nv">$contraseña</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span><span class="p">)</span> <span class="n">-FullName</span> <span class="s2">&quot;$nombre_usuario&quot;</span> 
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario con grupo $nombre_grupo no existe, se crea&quot;</span>
        <span class="p">}</span>
        
        <span class="c"># Verificar si el usuario pertenece al grupo específico</span>
        <span class="nv">$miembro_del_grupo</span> <span class="p">=</span> <span class="nb">Get-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombre_grupo</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="nv">$nombre_usuario</span> <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nv">$miembro_del_grupo</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario ya está en el grupo $nombre_grupo, no se hace nada&quot;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombre_grupo</span> <span class="n">-Member</span> <span class="nv">$nombre_usuario</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario no está en el grupo $nombre_grupo, se hace miembro&quot;</span>
        <span class="p">}</span>
        
        <span class="c"># Verificar si el usuario pertenece al grupo Usuarios, para que pueda  tener acceso con entorno gráfico</span>
        <span class="nv">$miembro_de_usuarios</span> <span class="p">=</span> <span class="nb">Get-LocalGroupMember</span> <span class="n">-Group</span> <span class="s2">&quot;Usuarios&quot;</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="nv">$nombre_usuario</span> <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nv">$miembro_de_usuarios</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario ya está en el grupo Usuarios, no se hace nada&quot;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="s2">&quot;Usuarios&quot;</span> <span class="n">-Member</span> <span class="nv">$nombre_usuario</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario no está en el grupo Usuarios, se hace miembro&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-19-19-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-19-19-0" name="19-0" role="tab" tabindex="0">crear_usuarios_grupos_csv.ps1</button><button aria-controls="panel-19-19-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-19-19-1" name="19-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-19-19-0" class="sphinx-tabs-panel" id="panel-19-19-0" name="19-0" role="tabpanel" tabindex="0"><p>Haz un script  llamado <strong>crear_usuarios_grupos_csv.ps1</strong>, que cree los usuarios que encontraras en  el archivo <a class="reference external" href="https://raw.githubusercontent.com/dgtrabada/dgtrabada.github.io/master/source/so/windows/10_powershell/users.csv">users.csv</a>, tiene que cumplir las siguientes condiciones:</p>
<ol class="arabic">
<li><p>En el caso de que el grupo no exista, haz que lo cree y saque por pantalla:</p>
<p><strong>El grupo $nombre_grupo no existe, se crea</strong></p>
</li>
<li><p>En el caso de que el grupo exista haz que no lo intente y saque por pantalla:</p>
<p><strong>El grupo $nombre_grupo existe, no se crea</strong></p>
</li>
<li><p>En el caso de que el usuario exista haz que no lo intente y saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario existe, no se crea</strong></p>
</li>
<li><p>En el caso de que el usuario no este en el grupo, haz que lo meta dentro del grupo y saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario no esta en el grupo $nombre_grupo, se hace miembro</strong></p>
</li>
<li><p>En el caso de que el usuario este en el grupo, haz que saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario ya esta en el grupo $nombre_grupo no se hace nada</strong></p>
</li>
<li><p>En el caso de que el usuario no exista, haz que lo cree y lo incorpore a su grupo, finalmente haz que saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario con grupo $nombre_grupo no existe, se crea</strong></p>
</li>
<li><p>Además se añada a un archivo el mensaje:</p>
<p><strong>El usuario $nombre_usuario con $passwrd en el grupo $nombre_grupo se ha creado &gt;&gt; lista_usuarios_creados.dat</strong></p>
</li>
<li><p>En el caso de que el usuario este en el grupo, haz que saque por pantalla:</p>
<p><strong>El usuario $nombre_usuario ya esta en el grupo $nombre_grupo no se hace nada</strong></p>
</li>
</ol>
</div><div aria-labelledby="tab-19-19-1" class="sphinx-tabs-panel" hidden="true" id="panel-19-19-1" name="19-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Script: crear_usuarios_grupos_csv.ps1</span>

<span class="c"># Leer el archivo CSV</span>
<span class="nv">$users</span> <span class="p">=</span> <span class="nb">Import-Csv</span> <span class="n">-Path</span> <span class="s2">&quot;users.csv&quot;</span>

<span class="c"># Recorrer cada usuario en el archivo CSV</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$user</span> <span class="k">in</span> <span class="nv">$users</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$nombre_usuario</span> <span class="p">=</span> <span class="nv">$user</span><span class="p">.</span><span class="n">usuario</span>
    <span class="nv">$nombre_grupo</span> <span class="p">=</span> <span class="nv">$user</span><span class="p">.</span><span class="n">grupo</span>
    <span class="nv">$password</span> <span class="p">=</span> <span class="nv">$user</span><span class="p">.</span><span class="n">password</span>
    <span class="nv">$entorno_grafico</span> <span class="p">=</span> <span class="nv">$user</span><span class="p">.</span><span class="n">EntGraf</span>

    <span class="c"># Verificar si el grupo existe</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">-Not</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombre_grupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombre_grupo no existe, se crea&quot;</span>
        <span class="nb">New-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombre_grupo</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombre_grupo existe, no se crea&quot;</span>
    <span class="p">}</span>

    <span class="c"># Verificar si el usuario existe</span>
    <span class="nv">$usuarioExiste</span> <span class="p">=</span> <span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombre_usuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$usuarioExiste</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario existe, no se crea&quot;</span>
        
        <span class="c"># Verificar si el usuario está en el grupo</span>
        <span class="nv">$miembroDelGrupo</span> <span class="p">=</span> <span class="nb">Get-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombre_grupo</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="nv">$nombre_usuario</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$miembroDelGrupo</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario ya está en el grupo $nombre_grupo, no se hace nada&quot;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario no está en el grupo $nombre_grupo, se hace miembro&quot;</span>
            <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombre_grupo</span> <span class="n">-Member</span> <span class="nv">$nombre_usuario</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c"># Crear el usuario</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario con grupo $nombre_grupo no existe, se crea&quot;</span>
        <span class="nb">New-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombre_usuario</span> <span class="n">-Password</span> <span class="p">(</span><span class="nb">ConvertTo-SecureString</span> <span class="nv">$password</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span><span class="p">)</span> <span class="n">-PasswordNeverExpires</span> <span class="n">-UserMayNotChangePassword</span>
        <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombre_grupo</span> <span class="n">-Member</span> <span class="nv">$nombre_usuario</span>
        <span class="nv">$logMessage</span> <span class="p">=</span> <span class="s2">&quot;El usuario $nombre_usuario con $password en el grupo $nombre_grupo se ha creado&quot;</span>
        <span class="nv">$logMessage</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">-FilePath</span> <span class="s2">&quot;lista_usuarios_creados.dat&quot;</span> <span class="n">-Append</span>
    <span class="p">}</span>

    <span class="c"># Verificar si el usuario debe tener acceso al entorno gráfico</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$entorno_grafico</span> <span class="o">-eq</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Verificar si el usuario está en el grupo Usuarios</span>
        <span class="nv">$miembroUsuarios</span> <span class="p">=</span> <span class="nb">Get-LocalGroupMember</span> <span class="n">-Group</span> <span class="s2">&quot;Usuarios&quot;</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="nv">$nombre_usuario</span> <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$miembroUsuarios</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario ya está en el grupo Usuarios, tiene acceso al entorno gráfico&quot;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario no está en el grupo Usuarios, se añade para acceso al entorno gráfico&quot;</span>
            <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="s2">&quot;Usuarios&quot;</span> <span class="n">-Member</span> <span class="nv">$nombre_usuario</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombre_usuario no requiere acceso al entorno gráfico&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-20-20-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-20-20-0" name="20-0" role="tab" tabindex="0">usuarios.ps1</button><button aria-controls="panel-20-20-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-20-20-1" name="20-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-20-20-0" class="sphinx-tabs-panel" id="panel-20-20-0" name="20-0" role="tabpanel" tabindex="0"><p>Haz un script llamado <strong>usuarios.ps1</strong>, que implementa un menú para gestionar usuarios en el sistema. El script permite listar usuarios, crear y eliminar usuarios, y modificar el nombre de un usuario existente.</p>
<p>Menú de Usuarios:</p>
<ol class="arabic simple">
<li><p>Listar usuarios</p></li>
<li><p>Crear usuario</p></li>
<li><p>Eliminar usuario</p></li>
<li><p>Modificar usuario</p></li>
<li><p>Salir</p></li>
</ol>
</div><div aria-labelledby="tab-20-20-1" class="sphinx-tabs-panel" hidden="true" id="panel-20-20-1" name="20-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Script: usuarios.ps1</span>

<span class="k">function</span> <span class="n">Listar-Usuarios</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Usuarios en el sistema:&quot;</span>
    <span class="nb">Get-LocalUser</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear-Usuario</span> <span class="p">{</span>
    <span class="nv">$nombreUsuario</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del nuevo usuario&quot;</span>
    <span class="nv">$password</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese la contraseña del nuevo usuario&quot;</span> <span class="n">-AsSecureString</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombreUsuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario ya existe.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">New-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombreUsuario</span> <span class="n">-Password</span> <span class="nv">$password</span> <span class="n">-FullName</span> <span class="nv">$nombreUsuario</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario ha sido creado.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar-Usuario</span> <span class="p">{</span>
    <span class="nv">$nombreUsuario</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del usuario a eliminar&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombreUsuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Remove-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombreUsuario</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario ha sido eliminado.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario no existe.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Modificar-Usuario</span> <span class="p">{</span>
    <span class="nv">$nombreUsuario</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del usuario a modificar&quot;</span>
    <span class="nv">$nuevoNombre</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nuevo nombre para el usuario&quot;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombreUsuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Rename-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nombreUsuario</span> <span class="n">-NewName</span> <span class="nv">$nuevoNombre</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario ha sido renombrado a $nuevoNombre.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario no existe.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;</span><span class="se">`n</span><span class="s2">Menú de Usuarios:&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;1. Listar usuarios&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;2. Crear usuario&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;3. Eliminar usuario&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;4. Modificar usuario&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;5. Salir&quot;</span>
    <span class="nv">$opcion</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Seleccione opción&quot;</span>

    <span class="k">switch</span> <span class="p">(</span><span class="nv">$opcion</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">1</span> <span class="p">{</span> <span class="n">Listar-Usuarios</span> <span class="p">}</span>
        <span class="n">2</span> <span class="p">{</span> <span class="n">Crear-Usuario</span> <span class="p">}</span>
        <span class="n">3</span> <span class="p">{</span> <span class="n">Eliminar-Usuario</span> <span class="p">}</span>
        <span class="n">4</span> <span class="p">{</span> <span class="n">Modificar-Usuario</span> <span class="p">}</span>
        <span class="n">5</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&quot;Saliendo...&quot;</span> <span class="p">}</span>
        <span class="k">Default</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&quot;Opción incorrecta. Intente de nuevo.&quot;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">until</span> <span class="p">(</span><span class="nv">$opcion</span> <span class="o">-eq</span> <span class="n">5</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-21-21-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-21-21-0" name="21-0" role="tab" tabindex="0">grupos.ps1</button><button aria-controls="panel-21-21-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-21-21-1" name="21-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-21-21-0" class="sphinx-tabs-panel" id="panel-21-21-0" name="21-0" role="tabpanel" tabindex="0"><p>Haz el script <strong>grupos.ps1</strong>, que implementa un menú para gestionar grupos y sus miembros en PowerShell. El script permite listar grupos, ver miembros, crear y eliminar grupos, así como agregar y eliminar miembros de los grupos.</p>
<p>Menú de Grupos:</p>
<ol class="arabic simple">
<li><p>Listar grupos</p></li>
<li><p>Ver miembros de un grupo</p></li>
<li><p>Crear grupo (pide nombre grupo)</p></li>
<li><p>Elimina grupo (pide nombre grupo)</p></li>
<li><p>Crea miembro de un grupo (pide grupo y usuario)</p></li>
<li><p>Elimina miembro de un grupo (pide grupo y usuario)</p></li>
<li><p>Salir</p></li>
</ol>
</div><div aria-labelledby="tab-21-21-1" class="sphinx-tabs-panel" hidden="true" id="panel-21-21-1" name="21-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Script: grupo.ps1</span>

<span class="k">function</span> <span class="n">Listar-Grupos</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Grupos disponibles:&quot;</span>
    <span class="nb">Get-LocalGroup</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Ver-MiembrosDeGrupo</span> <span class="p">{</span>
    <span class="nv">$nombreGrupo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del grupo&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombreGrupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;Miembros del grupo $nombreGrupo:&quot;</span>
        <span class="nb">Get-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombreGrupo</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Output</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombreGrupo no existe.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear-Grupo</span> <span class="p">{</span>
    <span class="nv">$nombreGrupo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del nuevo grupo&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombreGrupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombreGrupo ya existe.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">New-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombreGrupo</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombreGrupo ha sido creado.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar-Grupo</span> <span class="p">{</span>
    <span class="nv">$nombreGrupo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del grupo a eliminar&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombreGrupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Remove-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombreGrupo</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombreGrupo ha sido eliminado.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombreGrupo no existe.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear-MiembroDeGrupo</span> <span class="p">{</span>
    <span class="nv">$nombreGrupo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del grupo&quot;</span>
    <span class="nv">$nombreUsuario</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del usuario a agregar&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombreGrupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombreGrupo</span> <span class="n">-Member</span> <span class="nv">$nombreUsuario</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario ha sido agregado al grupo $nombreGrupo.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombreGrupo no existe.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar-MiembroDeGrupo</span> <span class="p">{</span>
    <span class="nv">$nombreGrupo</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del grupo&quot;</span>
    <span class="nv">$nombreUsuario</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Ingrese el nombre del usuario a eliminar&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nombreGrupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Remove-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$nombreGrupo</span> <span class="n">-Member</span> <span class="nv">$nombreUsuario</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El usuario $nombreUsuario ha sido eliminado del grupo $nombreGrupo.&quot;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Output</span> <span class="s2">&quot;El grupo $nombreGrupo no existe.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">do</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;</span><span class="se">`n</span><span class="s2">Menú de Grupos:&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;1. Listar grupos&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;2. Ver miembros de un grupo&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;3. Crear grupo&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;4. Eliminar grupo&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;5. Crear miembro de un grupo&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;6. Eliminar miembro de un grupo&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;7. Salir&quot;</span>
    <span class="nv">$opcion</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Seleccione opción&quot;</span>

    <span class="k">switch</span> <span class="p">(</span><span class="nv">$opcion</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">1</span> <span class="p">{</span> <span class="n">Listar-Grupos</span> <span class="p">}</span>
        <span class="n">2</span> <span class="p">{</span> <span class="n">Ver-MiembrosDeGrupo</span> <span class="p">}</span>
        <span class="n">3</span> <span class="p">{</span> <span class="n">Crear-Grupo</span> <span class="p">}</span>
        <span class="n">4</span> <span class="p">{</span> <span class="n">Eliminar-Grupo</span> <span class="p">}</span>
        <span class="n">5</span> <span class="p">{</span> <span class="n">Crear-MiembroDeGrupo</span> <span class="p">}</span>
        <span class="n">6</span> <span class="p">{</span> <span class="n">Eliminar-MiembroDeGrupo</span> <span class="p">}</span>
        <span class="n">7</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&quot;Saliendo...&quot;</span> <span class="p">}</span>
        <span class="k">Default</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="s2">&quot;Opción incorrecta. Intente de nuevo.&quot;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">until</span> <span class="p">(</span><span class="nv">$opcion</span> <span class="o">-eq</span> <span class="n">7</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-22-22-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-22-22-0" name="22-0" role="tab" tabindex="0">local_users.ps1</button><button aria-controls="panel-22-22-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-22-22-1" name="22-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-22-22-0" class="sphinx-tabs-panel" id="panel-22-22-0" name="22-0" role="tabpanel" tabindex="0"><p>Crea un script llamado <strong>local_users.ps1</strong>, que cumpla las siguientes condiciones</p>
<ol class="arabic">
<li><p>Si ejecutamos la ayuda:</p>
<img alt="../../_images/local_users_01.png" src="../../_images/local_users_01.png" />
</li>
<li><p>Si creamos un nuevo grupo, y listamos los grupos vemos que aparece.</p>
<p>Si volvemos a intentar crearlo vemos que no nos deja, recoge el error y sácalo por pantalla como se muestra a continuación.</p>
<img alt="../../_images/local_users_02.png" src="../../_images/local_users_02.png" />
<p>Finalmente crea el grupo grupo_tuapellido</p>
<p>En el caso de intentar borrar un grupo que no existe haz que saque el mensaje por pantalla:</p>
<img alt="../../_images/local_users_03.png" src="../../_images/local_users_03.png" />
</li>
<li><p>Si creamos un nuevo usuario llamado <strong>tunombre</strong>, se creara con la contraseña <code class="docutils literal notranslate"><span class="pre">&#64;lumn0</span></code></p>
<p>Después crea un usuario llamado <strong>tunombre1</strong> con una contraseña que no cumpla con las políticas de seguridad y haz que saque el error que muestra en el pantallazo sin crear el usuario.</p>
<p>Vuelve a crear el usuario <strong>tunombre1</strong> con una contraseña que cumpla con las políticas de seguridad</p>
<p>Crear el usuario <strong>tunombre2</strong> con una contraseña que cumpla con las políticas de seguridad en el grupo que no existe <strong>G2</strong>, en este caso el script deberá crear el grupo de forma automática.</p>
<p>Crear el usuario <strong>tunombre3</strong> con una contraseña que cumpla con las políticas de seguridad en el grupo que ahora si existe <strong>G2</strong>.</p>
<p>Por ultimo lista los miembros del grupo <strong>G2</strong></p>
<img alt="../../_images/local_users_04.png" src="../../_images/local_users_04.png" />
</li>
<li><p>Mete al usuario <strong>tunombre3</strong> en grupo <strong>G3</strong> que no existe sin poner <strong>-usuario</strong> ni <strong>-grupo</strong>, haz que salga el mensaje de error.</p>
<p>Mete al usuario <strong>tunombre3</strong> en grupo <strong>G3</strong> que no existe sin poner  <strong>-grupo</strong>, haz que salga el mensaje de error.</p>
<p>Mete al usuario <strong>tunombre3</strong> en grupo <strong>G3</strong>  haz que salga el mensaje de error.</p>
<p>Crea el grupo <strong>G3</strong> y mete finalmente al usuario <strong>tunombre3</strong> en grupo <strong>G3</strong>.</p>
<p>Lista los usuarios del grupo <strong>G3</strong></p>
<p>Elimina el usuario <strong>tunombre3</strong> del grupo <strong>G3</strong> (haz que se recojan los mismo errores cuando eliminamos usuarios de un grupo que cuando los metemos)</p>
<p>Lista los usuarios del grupo <strong>G3</strong> y <strong>G2</strong></p>
<img alt="../../_images/local_users_05.png" src="../../_images/local_users_05.png" />
</li>
<li><p>Por ultimo ejecuta el script <a class="reference external" href="images/test_local_users.ps1">test_local_users.ps1</a>. para probar el script</p>
<img alt="../../_images/local_users_06.png" src="../../_images/local_users_06.png" />
</li>
</ol>
</div><div aria-labelledby="tab-22-22-1" class="sphinx-tabs-panel" hidden="true" id="panel-22-22-1" name="22-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">param</span> <span class="p">(</span>
    <span class="no">[string]</span><span class="nv">$password</span> <span class="p">=</span> <span class="s2">&quot;@lumn0&quot;</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$nuevo_usuario</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$grupo</span><span class="p">,</span> <span class="c">#cuando creamos un nuevo usuario lo metemos dentro de este grupo si existe si no lo creamos, tambien para añadir y quitar usuarios del grupo</span>
    <span class="no">[string]</span><span class="nv">$usuario</span><span class="p">,</span> <span class="c">#lo usasmos para añadir usuarios y quitar usuarios del grupo </span>
    <span class="no">[string]</span><span class="nv">$listar_miembros_grupo</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$nuevo_grupo</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$eliminar_grupo</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$eliminar_usuario</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$eliminar_usuario_grupo</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$meter_usuario_grupo</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$help</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$listar_usuarios</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$listar_grupos</span>
    <span class="p">)</span>
   

<span class="k">function</span> <span class="n">help</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Mostrar ayuda&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>    
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1  -help&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Listar los grupos&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1  -listar_grupos&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Crear un nuevo grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1 -nuevo_grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Eliminar un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1 -eliminar_grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Crear un nuevo usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1 -nuevo_usuario [usuario]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1 -nuevo_usuario [usuario] -password [password]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1 -nuevo_usuario [usuario] -password [password] -grupo [Grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Eliminar un usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1 -eliminar_usuario [usuario]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Listar los miembros de un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;local_users.ps1 -listar_miembros_grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Meter un usuario a un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;.\local_users.ps1 -meter_usuario_grupo -usuario [usuario] -grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Eliminar usuario de un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;.\local_users.ps1 -eliminar_usuario_grupo -usuario [usuario] -grupo [grupo]&quot;</span>
<span class="p">}</span> 

<span class="k">function</span> <span class="n">Listar_Grupos</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Grupos disponibles:&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="nb">Get-LocalGroup</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Listar_MiembrosDeGrupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$listar_miembros_grupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Miembros del grupo $listar_miembros_grupo :&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
        <span class="nb">Get-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$listar_miembros_grupo</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $listar_miembros_grupo no existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nuevo_grupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $nuevo_grupo ya existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">New-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$nuevo_grupo</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Creamos el grupo: $nuevo_grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$eliminar_grupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Remove-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$eliminar_grupo</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $eliminar_grupo ha sido eliminado.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $eliminar_grupo no existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Meter_Usuario_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$grupo</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$usuario</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$grupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">))</span>  <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $grupo no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$usuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$grupo</span> <span class="n">-Member</span> <span class="nv">$usuario</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario ha sido agregado al grupo $grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar_Usuario_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$grupo</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$usuario</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$grupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">))</span>  <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $grupo no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$usuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Remove-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$grupo</span> <span class="n">-Member</span> <span class="nv">$usuario</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario ha sido eliminado del grupo $grupo.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Listar_Usuarios</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Usuarios en el sistema:&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="nb">Get-LocalUser</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear_Usuario</span> <span class="p">{</span>
    <span class="nv">$ErrorActionPreference</span><span class="p">=</span><span class="s2">&quot;Stop&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nuevo_usuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $nuevo_usuario ya existe.&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$usuario_creado</span><span class="p">=</span><span class="nv">$True</span>
        <span class="k">try</span><span class="p">{</span>
           <span class="nv">$cadena_secure_string</span> <span class="p">=</span> <span class="nv">$password</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
           <span class="nb">New-LocalUser</span> <span class="n">-Name</span> <span class="nv">$nuevo_usuario</span> <span class="n">-Password</span>  <span class="nv">$cadena_secure_string</span>  <span class="n">-FullName</span> <span class="nv">$nuevo_usuario</span>          
           <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $nuevo_usuario ha sido creado y añadido al grupo Users.&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Green</span>
        <span class="p">}</span><span class="k">catch</span><span class="p">{</span>
           <span class="nv">$usuario_creado</span><span class="p">=</span><span class="nv">$False</span>
           <span class="nb">Write-Host</span> <span class="s2">&quot;Error: la contraseña no cumple con los requititos no creamos el usuario $nuevo_usuario &quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Red</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$usuario_creado</span><span class="p">){</span>
           <span class="c"># Para que los usuarios puedan iniciar sesión con entorno gráfico</span>
           <span class="c"># Add-LocalGroupMember -Group &quot;Users&quot; -Member $nuevo_usuario</span>
           <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$grupo</span><span class="p">)){</span>
               <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$grupo</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">))</span> <span class="p">{</span>
                   <span class="nb">New-LocalGroup</span> <span class="n">-Name</span> <span class="nv">$grupo</span>
                   <span class="nb">Write-Host</span> <span class="s2">&quot;Creamos el grupo: $grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
                   <span class="p">}</span>
                <span class="nb">Add-LocalgroupMember</span> <span class="n">-Group</span> <span class="nv">$grupo</span> <span class="n">-Member</span> <span class="nv">$nuevo_usuario</span>
                <span class="nb">Write-Host</span> <span class="s2">&quot;Metemos al usuario $nuevo_usuario en el grupo $grupo&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Green</span>
           <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$ErrorActionPreference</span><span class="p">=</span><span class="s2">&quot;Continue&quot;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar_Usuario</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="nv">$eliminar_usuario</span> <span class="n">-ErrorAction</span> <span class="n">SilentlyContinue</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Remove-LocalUser</span> <span class="n">-Name</span> <span class="nv">$eliminar_usuario</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $eliminar_usuario ha sido eliminado.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $eliminar_usuario no existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="k">if</span> <span class="p">(</span><span class="nv">$help</span><span class="p">){</span><span class="n">help</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$listar_grupos</span><span class="p">){</span><span class="n">Listar_Grupos</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$listar_miembros_grupo</span><span class="p">)){</span><span class="n">Listar_MiembrosDeGrupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$nuevo_grupo</span><span class="p">)){</span><span class="n">Crear_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$eliminar_grupo</span><span class="p">)){</span><span class="n">Eliminar_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$meter_usuario_grupo</span><span class="p">){</span><span class="n">Meter_Usuario_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$eliminar_usuario_grupo</span><span class="p">){</span><span class="n">Eliminar_Usuario_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$listar_usuarios</span><span class="p">){</span><span class="n">Listar_Usuarios</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$nuevo_usuario</span><span class="p">)){</span><span class="n">Crear_Usuario</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$eliminar_usuario</span><span class="p">)){</span><span class="n">Eliminar_Usuario</span><span class="p">}</span>

<span class="c">#function prompt { &quot;PS C:\&gt; &quot;}</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-23-23-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-23-23-0" name="23-0" role="tab" tabindex="0">AD.ps1</button><button aria-controls="panel-23-23-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-23-23-1" name="23-1" role="tab" tabindex="-1">Solución</button></div><div aria-labelledby="tab-23-23-0" class="sphinx-tabs-panel" id="panel-23-23-0" name="23-0" role="tabpanel" tabindex="0"><p>Crea un script llamado <strong>AD.ps1</strong>, que cumpla las siguientes condiciones</p>
<ol class="arabic">
<li><p>Instala el Active directory utiliza como nombre de dominio : <strong>tunombre.local</strong></p>
<p>Haz que toda la decencia con el nombre del dominio dentro del script se haga con las siguientes variables: <code class="docutils literal notranslate"><span class="pre">$dirAD=&quot;DC=tunombre,DC=local&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">$mail=&quot;&#64;tunombre.local&quot;</span></code></p>
</li>
<li><p>Si ejecutamos:</p>
<img alt="../../_images/AD_01.png" src="../../_images/AD_01.png" />
</li>
<li><p>Si ejecutamos:</p>
<img alt="../../_images/AD_02.png" src="../../_images/AD_02.png" />
</li>
<li><p>Haz que cree, borre y liste las unidades organizativas, si intenta crearlas y ya existe haz que salga un error por pantalla, en el caso de que intente eliminarlas y no existan haz que salga otro error por pantalla.</p>
<img alt="../../_images/AD_03.png" src="../../_images/AD_03.png" />
</li>
<li><p>Haz que cree, borre y liste los grupos del AD, si intenta crearlos y ya existe haz que salga un error por pantalla, en el caso de que intente eliminarlas y no existan haz que salga otro error por pantalla.</p>
<img alt="../../_images/AD_04.png" src="../../_images/AD_04.png" />
<img alt="../../_images/AD_05.png" src="../../_images/AD_05.png" />
</li>
<li><p>Haz que cree, borre y liste los usuarios del AD, si intenta crearlos y ya existe haz que salga un error por pantalla, en el caso de que intente eliminarlas y no existan haz que salga otro error por pantalla, al igual que antes si intenta crear usuarios con una contraseña insegura que de te un error, si intenta crearlo en un grupo que no existe que cree el grupo antes:</p>
<img alt="../../_images/AD_06.png" src="../../_images/AD_06.png" />
</li>
<li><p>Por ultimo ejecuta el script test_AD.ps1 para probar el script</p>
<img alt="../../_images/AD_07.png" src="../../_images/AD_07.png" />
</li>
</ol>
</div><div aria-labelledby="tab-23-23-1" class="sphinx-tabs-panel" hidden="true" id="panel-23-23-1" name="23-1" role="tabpanel" tabindex="0"><div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">param</span> <span class="p">(</span>
    <span class="no">[string]</span><span class="nv">$password</span> <span class="p">=</span> <span class="s2">&quot;@lumn01234&quot;</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$nuevo_usuario</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$grupo</span><span class="p">,</span> <span class="c">#cuando creamos un nuevo usuario lo metemos dentro de este grupo si existe si no lo creamos, tambien para añadir y quitar usuarios del grupo</span>
    <span class="no">[string]</span><span class="nv">$usuario</span><span class="p">,</span> <span class="c">#lo usasmos para añadir usuarios y quitar usuarios del grupo </span>
    <span class="no">[string]</span><span class="nv">$listar_miembros_grupo</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$nuevo_grupo</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$eliminar_grupo</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$eliminar_usuario</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$eliminar_usuario_grupo</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$meter_usuario_grupo</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$help</span><span class="p">,</span>

    <span class="no">[switch]</span><span class="nv">$listar_usuarios</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$listar_grupos</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$info</span><span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$nueva_OU</span> <span class="p">,</span>
    <span class="no">[string]</span><span class="nv">$eliminar_OU</span><span class="p">,</span>
    <span class="no">[switch]</span><span class="nv">$listar_OU</span>
    <span class="p">)</span>
   
 <span class="nv">$dirAD</span><span class="p">=</span><span class="s2">&quot;DC=tunombre,DC=local&quot;</span>
 <span class="nv">$mail</span><span class="p">=</span><span class="s2">&quot;@tunombre.local&quot;</span>

<span class="k">function</span> <span class="n">Info</span> <span class="p">{</span> <span class="nb">Get-ADComputer</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">}</span>

<span class="k">function</span> <span class="n">help</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Mostrar ayuda&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>    
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1  -help&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Mostrar información del AD&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>    
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1  -info&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Listar las unidades organizativas&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1  -listar_OU&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Crear una nueva unidades organizativas&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -nuevo_OU [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Borrar una unidad organizativas&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -eliminar_OU [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Listar los grupos&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1  -listar_grupos&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Crear un nuevo grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -nuevo_grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Eliminar un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -eliminar_grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Crear un nuevo usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -nuevo_usuario [usuario]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -nuevo_usuario [usuario] -password [password]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -nuevo_usuario [usuario] -password [password] -grupo [Grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Eliminar un usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -eliminar_usuario [usuario]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Listar los miembros de un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;AD.ps1 -listar_miembros_grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Meter un usuario a un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span> 
    <span class="nb">Write-Host</span> <span class="s2">&quot;.\AD.ps1 -meter_usuario_grupo -usuario [usuario] -grupo [grupo]&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;&quot;</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Eliminar usuario de un grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Gray</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;.\AD.ps1 -eliminar_usuario_grupo -usuario [usuario] -grupo [grupo]&quot;</span>
<span class="p">}</span> 

<span class="k">function</span> <span class="n">Listar_Grupos</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Grupos disponibles:&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="nb">Get-ADGroup</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Listar_MiembrosDeGrupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-ADGroup</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$listar_miembros_grupo&#39;&quot;</span><span class="p">){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Miembros del grupo $listar_miembros_grupo :&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
        <span class="nb">Get-ADGroupMember</span> <span class="n">-Identity</span> <span class="nv">$listar_miembros_grupo</span> 
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $listar_miembros_grupo no existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-ADGroup</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$nuevo_grupo&#39;&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $nuevo_grupo ya existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">New-ADGroup</span> <span class="n">-DisplayName</span> <span class="nv">$nuevo_grupo</span> <span class="n">-Name</span>  <span class="nv">$nuevo_grupo</span> <span class="n">-GroupScope</span> <span class="n">DomainLocal</span> <span class="n">-GroupCategory</span> <span class="n">Security</span> <span class="n">-Path</span> <span class="nv">$dirAD</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Creamos el grupo: $nuevo_grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-ADGroup</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$eliminar_grupo&#39;&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Remove-ADGroup</span> <span class="n">-Identity</span> <span class="nv">$eliminar_grupo</span> <span class="n">-Confirm</span><span class="p">:</span><span class="nv">$false</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $eliminar_grupo ha sido eliminado.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $eliminar_grupo no existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Meter_Usuario_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$grupo</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$usuario</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-ADGroup</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$grupo&#39;&quot;</span><span class="p">))</span>  <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $grupo no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$usuario&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Add-ADGroupMember</span> <span class="n">-Identity</span>  <span class="nv">$grupo</span> <span class="n">-Members</span> <span class="nv">$usuario</span>
        <span class="nb">Add-LocalGroupMember</span> <span class="n">-Group</span> <span class="nv">$grupo</span> <span class="n">-Member</span> <span class="nv">$usuario</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario ha sido agregado al grupo $grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar_Usuario_Grupo</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$grupo</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$usuario</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;Necesitamos el parametro -usuario&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-ADGroup</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$grupo&#39;&quot;</span><span class="p">))</span>  <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El grupo $grupo no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span><span class="k">elseif</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$nuevo_usuario&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario no existe&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Remove-ADGroupMember</span> <span class="n">-Identity</span> <span class="nv">$grupo</span> <span class="n">-Members</span> <span class="nv">$usuario</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $usuario ha sido eliminado del grupo $grupo.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Listar_Usuarios</span> <span class="p">{</span>
    <span class="nb">Write-Host</span> <span class="s2">&quot;Usuarios en el A:&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Name</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear_Usuario</span> <span class="p">{</span>
    <span class="nv">$ErrorActionPreference</span><span class="p">=</span><span class="s2">&quot;Stop&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$nuevo_usuario&#39;&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $nuevo_usuario ya existe.&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$usuario_creado</span><span class="p">=</span><span class="nv">$True</span>
        <span class="k">try</span><span class="p">{</span>
           <span class="nv">$cadena_secure_string</span> <span class="p">=</span> <span class="nv">$password</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
           <span class="nb">New-AdUser</span> <span class="n">-Name</span> <span class="nv">$nuevo_usuario</span> <span class="n">-SamAccountName</span> <span class="nv">$nuevo_usuario</span> <span class="n">-UserPrincipalName</span> <span class="nv">$nuevo_usuario$mail</span> <span class="n">-GivenName</span> <span class="nv">$nuevo_usuario</span> <span class="n">-AccountPassword</span>  <span class="nv">$cadena_secure_string</span>  <span class="n">-Enabled</span> <span class="nv">$True</span>
           <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $nuevo_usuario ha sido creado y añadido al grupo Users.&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Green</span>
        <span class="p">}</span><span class="k">catch</span><span class="p">{</span>
           <span class="nv">$usuario_creado</span><span class="p">=</span><span class="nv">$False</span>
           <span class="nb">Write-Host</span> <span class="s2">&quot;Error: la contraseña no cumple con los requititos no creamos el usuario $nuevo_usuario &quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Red</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$usuario_creado</span><span class="p">){</span>
           <span class="c"># Para que los usuarios puedan iniciar sesión con entorno gráfico</span>
           <span class="c"># Add-LocalGroupMember -Group &quot;Users&quot; -Member $nuevo_usuario</span>
           <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$grupo</span><span class="p">)){</span>
              <span class="k">if</span><span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-ADGroup</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$grupo&#39;&quot;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nb">New-ADGroup</span> <span class="n">-DisplayName</span> <span class="nv">$grupo</span> <span class="n">-Name</span>  <span class="nv">$grupo</span> <span class="n">-GroupScope</span> <span class="n">DomainLocal</span> <span class="n">-GroupCategory</span> <span class="n">Security</span> <span class="n">-Path</span> <span class="nv">$dirAD</span>                    
                <span class="nb">Write-Host</span> <span class="s2">&quot;Creamos el grupo: $grupo&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
                <span class="p">}</span>
              <span class="nb">Add-ADGroupMember</span> <span class="n">-Identity</span> <span class="nb">Group </span><span class="nv">$grupo</span> <span class="n">-Member</span> <span class="nv">$nuevo_usuario</span>
              <span class="nb">Write-Host</span> <span class="s2">&quot;Metemos al usuario $nuevo_usuario en el grupo $grupo&quot;</span>  <span class="n">-ForegroundColor</span> <span class="n">Green</span>
           <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nv">$ErrorActionPreference</span><span class="p">=</span><span class="s2">&quot;Continue&quot;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar_Usuario</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$eliminar_usuario&#39;&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Remove-ADUser</span> <span class="n">-Identity</span> <span class="nv">$eliminar_usuario</span> <span class="n">-Confirm</span><span class="p">:</span><span class="nv">$false</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $eliminar_usuario ha sido eliminado.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;El usuario $eliminar_usuario no existe.&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Crear_OU</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">Get-ADOrganizationalUnit</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$nueva_OU&#39;&quot;</span><span class="p">){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;$nueva_OU existe no se crea&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span> 
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nb">New-ADOrganizationalUnit</span> <span class="n">-DisplayName</span> <span class="nv">$nueva_OU</span> <span class="n">-Name</span> <span class="nv">$nueva_OU</span> <span class="n">-path</span> <span class="s2">&quot;DC=tunombre,DC=local&quot;</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;$nueva_OU se ha creado&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">Eliminar_OU</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Get-ADOrganizationalUnit</span> <span class="n">-Filter</span> <span class="s2">&quot;Name -eq &#39;$eliminar_OU&#39;&quot;</span><span class="p">)){</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;$eliminar_OU no existe no se elimina&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Red</span> 
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nb">Set-ADOrganizationalUnit</span> <span class="n">-Identity</span> <span class="s2">&quot;OU=$eliminar_OU,DC=tunombre,DC=local&quot;</span> <span class="n">-ProtectedFromAccidentalDeletion</span> <span class="nv">$False</span>
        <span class="nb">Remove-ADOrganizationalUnit</span> <span class="n">-Identity</span> <span class="s2">&quot;OU=$eliminar_OU,DC=tunombre,DC=local&quot;</span> <span class="n">-Recursive</span> <span class="n">-Confirm</span><span class="p">:</span><span class="nv">$false</span>
        <span class="nb">Write-Host</span> <span class="s2">&quot;$eliminar_OU se ha eliminado de forma recursiva sin confirmación&quot;</span> <span class="n">-ForegroundColor</span> <span class="n">Green</span>
    <span class="p">}</span>
<span class="p">}</span>



<span class="k">if</span> <span class="p">(</span><span class="nv">$help</span><span class="p">){</span><span class="n">help</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$listar_grupos</span><span class="p">){</span><span class="n">Listar_Grupos</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$listar_miembros_grupo</span><span class="p">)){</span><span class="n">Listar_MiembrosDeGrupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$nuevo_grupo</span><span class="p">)){</span><span class="n">Crear_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$eliminar_grupo</span><span class="p">)){</span><span class="n">Eliminar_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$meter_usuario_grupo</span><span class="p">){</span><span class="n">Meter_Usuario_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$eliminar_usuario_grupo</span><span class="p">){</span><span class="n">Eliminar_Usuario_Grupo</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$listar_usuarios</span><span class="p">){</span><span class="n">Listar_Usuarios</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$nuevo_usuario</span><span class="p">)){</span><span class="n">Crear_Usuario</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$eliminar_usuario</span><span class="p">)){</span><span class="n">Eliminar_Usuario</span><span class="p">}</span>
<span class="c">#--AD--</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$info</span><span class="p">){</span><span class="n">Info</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$nueva_OU</span><span class="p">)){</span><span class="n">Crear_OU</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="no">[String]</span><span class="p">::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$eliminar_OU</span><span class="p">)){</span><span class="n">Eliminar_OU</span><span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$listar_OU</span><span class="p">){</span>
    <span class="nb">Get-ADOrganizationalUnit</span> <span class="n">-LDAPFilter</span> <span class="s2">&quot;(name=*)&quot;</span>  <span class="p">|</span> <span class="nb">FT </span><span class="n">Name</span><span class="p">,</span><span class="n">DistinguishedName</span>
    <span class="p">}</span>

<span class="c">#function prompt { &quot;PS C:\&gt; &quot;}</span>
</pre></div>
</div>
</div></div>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="10_powershell_scripting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title">PowerShell Scripting</p>
      </div>
    </a>
    <a class="right-next"
       href="11_bat.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title">Scripting .bat</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por dgtrabada
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>